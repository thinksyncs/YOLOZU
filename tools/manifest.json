{
  "manifest_version": 1,
  "repo": {
    "name": "YOLOZU",
    "description": "Apache-2.0-only evaluation + tooling harness (CPU-first) for detection/pose workflows."
  },
  "contracts": {
    "predictions_json": {
      "summary": "YOLOZU predictions JSON (list of {image,detections} or {predictions:[...],meta:{...}}).",
      "schema": "docs/schemas/predictions.schema.json",
      "validator": "python3 tools/validate_predictions.py <path> [--strict]"
    },
    "metrics_report_json": {
      "summary": "Stable metrics report schema emitted by yolozu.metrics_report.build_report().",
      "schema": "docs/schemas/metrics_report.schema.json",
      "builder": "yolozu/metrics_report.py"
    },
    "coco_eval_report_json": {
      "summary": "Report payload emitted by tools/eval_coco.py (COCOeval or dry-run conversion).",
      "schema": "docs/schemas/coco_eval_report.schema.json",
      "producer": "python3 tools/eval_coco.py"
    },
    "eval_suite_report_json": {
      "summary": "Report payload emitted by tools/eval_suite.py (suite over prediction JSONs).",
      "schema": "docs/schemas/eval_suite_report.schema.json",
      "producer": "python3 tools/eval_suite.py"
    },
    "seg_dataset_json": {
      "summary": "Segmentation dataset.json descriptor produced by tools/prepare_*_seg.py.",
      "schema": "docs/schemas/seg_dataset.schema.json"
    },
    "segmentation_predictions_json": {
      "summary": "Segmentation predictions JSON (list of {id,mask} or {predictions:[...],meta:{...}}).",
      "schema": "docs/schemas/segmentation_predictions.schema.json",
      "validator": "python3 tools/validate_segmentation_predictions.py <path>"
    },
    "seg_eval_report_json": {
      "summary": "Segmentation eval report payload emitted by tools/eval_segmentation.py.",
      "schema": "docs/schemas/seg_eval_report.schema.json",
      "producer": "python3 tools/eval_segmentation.py"
    },
    "instance_segmentation_predictions_json": {
      "summary": "Instance segmentation predictions JSON (list of {image,instances} or {predictions:[...],meta:{...}}).",
      "schema": "docs/schemas/instance_segmentation_predictions.schema.json",
      "validator": "python3 tools/validate_instance_segmentation_predictions.py <path>"
    },
    "instance_seg_eval_report_json": {
      "summary": "Instance segmentation eval report payload emitted by tools/eval_instance_segmentation.py.",
      "schema": "docs/schemas/instance_seg_eval_report.schema.json",
      "producer": "python3 tools/eval_instance_segmentation.py"
    },
    "run_meta_json": {
      "summary": "Run provenance metadata contract emitted at runs/<run_id>/reports/run_meta.json.",
      "schema": "docs/schemas/run_meta.schema.json",
      "validator": "python3 tools/validate_run_meta.py <path>"
    }
  },
  "tools": [
    {
      "id": "fetch_coco128",
      "entrypoint": "tools/fetch_coco128.sh",
      "runner": "bash",
      "summary": "Fetch tiny COCO subset (YOLO-format) into data/coco128 (official COCO hosting).",
      "tags": ["dataset"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "requires": { "network": true },
      "inputs": [],
      "effects": {
        "writes": [],
        "fixed_writes": [
          {
            "path": "data/coco128",
            "kind": "dir",
            "scope": "tree",
            "description": "Download + extract dataset to data/coco128."
          }
        ]
      },
      "outputs": [
        { "name": "dataset_root", "kind": "dir", "description": "Created dataset root.", "default": "data/coco128" }
      ],
      "examples": [
        { "description": "Fetch dataset once for tests/smoke.", "command": "bash tools/fetch_coco128.sh" }
      ]
    },
    {
      "id": "make_subset_dataset",
      "entrypoint": "tools/make_subset_dataset.py",
      "runner": "python3",
      "summary": "Create a deterministic subset YOLO dataset (symlink/copy images+labels) for reproducible eval/ablation runs.",
      "tags": ["dataset"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "inputs": [
        { "name": "dataset", "kind": "dir", "required": true, "flag": "--dataset" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split", "default": null },
        { "name": "n", "kind": "number", "required": false, "flag": "--n", "default": 50 },
        { "name": "seed", "kind": "number", "required": false, "flag": "--seed", "default": 0 },
        { "name": "out", "kind": "dir", "required": false, "flag": "--out", "default": "reports/subset_dataset" },
        { "name": "copy", "kind": "string", "required": false, "flag": "--copy" },
        { "name": "overwrite", "kind": "string", "required": false, "flag": "--overwrite" },
        { "name": "strategy", "kind": "string", "required": false, "flag": "--strategy" }
      ],
      "effects": {
        "writes": [
          {
            "flag": "--out",
            "kind": "dir",
            "scope": "tree",
            "description": "Writes subset dataset tree under --out (images/ + labels/ + subset metadata)."
          }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "dataset_root", "kind": "dir", "description": "Subset dataset root created at --out." },
        { "name": "subset_json", "kind": "file", "description": "Subset metadata (image list + sha).", "default": "<out>/subset.json" },
        { "name": "subset_images_txt", "kind": "file", "description": "Frozen image list.", "default": "<out>/subset_images.txt" }
      ],
      "examples": [
        {
          "description": "Create a frozen 50-image subset for ablations.",
          "command": "python3 tools/make_subset_dataset.py --dataset data/coco128 --split train2017 --n 50 --seed 0 --out reports/coco128_50"
        }
      ]
    },
    {
      "id": "prepare_coco_yolo",
      "entrypoint": "tools/prepare_coco_yolo.py",
      "runner": "python3",
      "summary": "Convert official COCO instances JSON into YOLO-format labels + (optional) copy images.",
      "tags": ["dataset", "coco"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "inputs": [
        { "name": "coco_root", "kind": "dir", "required": true, "flag": "--coco-root" },
        { "name": "out", "kind": "dir", "required": true, "flag": "--out" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split", "default": "val2017" },
        { "name": "include_crowd", "kind": "string", "required": false, "flag": "--include-crowd" },
        { "name": "instances_json", "kind": "file", "required": false, "flag": "--instances-json" },
        { "name": "copy_images", "kind": "string", "required": false, "flag": "--copy-images" }
      ],
      "effects": {
        "writes": [
          {
            "flag": "--out",
            "kind": "dir",
            "scope": "tree",
            "description": "Writes YOLO-format dataset under --out (labels/ + dataset.json, optionally images/)."
          }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "dataset_root", "kind": "dir", "description": "YOLO-format dataset root created at --out." },
        { "name": "dataset_descriptor", "kind": "file", "description": "Convenience dataset.json.", "default": "<out>/dataset.json" }
      ],
      "examples": [
        {
          "description": "Prepare val2017 labels without copying images.",
          "command": "python3 tools/prepare_coco_yolo.py --coco-root /path/to/coco --split val2017 --out data/coco-yolo"
        }
      ]
    },
    {
      "id": "prepare_coco_instance_seg",
      "entrypoint": "tools/prepare_coco_instance_seg.py",
      "runner": "python3",
      "summary": "Convert official COCO instances JSON into YOLO-format labels + per-instance PNG masks + sidecar metadata for instance-seg eval.",
      "tags": ["dataset", "coco", "instance_segmentation"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "inputs": [
        { "name": "coco_root", "kind": "dir", "required": true, "flag": "--coco-root" },
        { "name": "out", "kind": "dir", "required": true, "flag": "--out" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split", "default": "val2017" },
        { "name": "include_crowd", "kind": "string", "required": false, "flag": "--include-crowd" },
        { "name": "instances_json", "kind": "file", "required": false, "flag": "--instances-json" },
        { "name": "copy_images", "kind": "string", "required": false, "flag": "--copy-images" },
        { "name": "max_instances_per_image", "kind": "number", "required": false, "flag": "--max-instances-per-image" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" }
      ],
      "effects": {
        "writes": [
          {
            "flag": "--out",
            "kind": "dir",
            "scope": "tree",
            "description": "Writes YOLO-format dataset under --out (labels/ + masks/ + dataset.json)."
          }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "dataset_root", "kind": "dir", "description": "YOLO-format dataset root created at --out." },
        { "name": "dataset_descriptor", "kind": "file", "description": "Convenience dataset.json.", "default": "<out>/dataset.json" }
      ],
      "examples": [
        {
          "description": "Prepare val2017 labels+masks (pycocotools required).",
          "command": "python3 tools/prepare_coco_instance_seg.py --coco-root /path/to/coco --split val2017 --out data/coco-instance-seg"
        }
      ]
    },
    {
      "id": "convert_coco_instance_seg_predictions",
      "entrypoint": "tools/convert_coco_instance_seg_predictions.py",
      "runner": "python3",
      "summary": "Convert COCO instance segmentation predictions (polygons/RLE) into YOLOZU instance-seg PNG-mask contract.",
      "tags": ["coco", "instance_segmentation", "predictions", "convert"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "produces": ["instance_segmentation_predictions_json"] },
      "inputs": [
        { "name": "predictions", "kind": "file", "required": true, "flag": "--predictions" },
        { "name": "instances_json", "kind": "file", "required": true, "flag": "--instances-json" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/instance_seg_predictions.json" },
        { "name": "masks_dir", "kind": "dir", "required": false, "flag": "--masks-dir", "default": "reports/instance_seg_masks" },
        { "name": "min_score", "kind": "number", "required": false, "flag": "--min-score" },
        { "name": "max_preds", "kind": "number", "required": false, "flag": "--max-preds" }
      ],
      "effects": {
        "writes": [
          {
            "flag": "--output",
            "kind": "file",
            "scope": "path",
            "description": "Writes instance segmentation predictions JSON."
          },
          {
            "flag": "--masks-dir",
            "kind": "dir",
            "scope": "tree",
            "description": "Writes per-instance PNG masks under --masks-dir."
          }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "predictions_json", "kind": "file", "default": "reports/instance_seg_predictions.json" },
        { "name": "masks_dir", "kind": "dir", "default": "reports/instance_seg_masks" }
      ],
      "examples": [
        {
          "description": "Convert COCO predictions to YOLOZU PNG masks (pycocotools required).",
          "command": "python3 tools/convert_coco_instance_seg_predictions.py --predictions /path/to/coco_preds.json --instances-json /path/to/instances_val2017.json --output reports/instance_seg_predictions.json --masks-dir reports/instance_seg_masks"
        }
      ]
    },
    {
      "id": "prepare_cityscapes_seg",
      "entrypoint": "tools/prepare_cityscapes_seg.py",
      "runner": "python3",
      "summary": "Prepare Cityscapes semantic segmentation layout + dataset.json manifest.",
      "tags": ["dataset", "cityscapes", "segmentation"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "inputs": [
        { "name": "cityscapes_root", "kind": "dir", "required": true, "flag": "--cityscapes-root" },
        { "name": "out", "kind": "dir", "required": true, "flag": "--out" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split", "default": "train" },
        { "name": "label_type", "kind": "string", "required": false, "flag": "--label-type" },
        { "name": "mode", "kind": "string", "required": false, "flag": "--mode" },
        { "name": "force", "kind": "string", "required": false, "flag": "--force" }
      ],
      "effects": {
        "writes": [
          {
            "flag": "--out",
            "kind": "dir",
            "scope": "tree",
            "description": "Writes prepared segmentation dataset layout under --out (manifest + optional symlinks/copies)."
          }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "dataset_root", "kind": "dir", "description": "Prepared output root created at --out." },
        { "name": "dataset_descriptor", "kind": "file", "description": "dataset.json manifest.", "default": "<out>/dataset.json" }
      ],
      "examples": [
        {
          "description": "Create a manifest-only dataset.json (no copying).",
          "command": "python3 tools/prepare_cityscapes_seg.py --cityscapes-root /path/to/cityscapes --split train --out data/cityscapes_seg --mode manifest"
        }
      ]
    },
    {
      "id": "prepare_voc_seg",
      "entrypoint": "tools/prepare_voc_seg.py",
      "runner": "python3",
      "summary": "Prepare Pascal VOC semantic segmentation layout + dataset.json manifest.",
      "tags": ["dataset", "pascal_voc", "voc", "segmentation"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "inputs": [
        { "name": "voc_root", "kind": "dir", "required": true, "flag": "--voc-root" },
        { "name": "out", "kind": "dir", "required": true, "flag": "--out" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split", "default": "train" },
        { "name": "mode", "kind": "string", "required": false, "flag": "--mode" },
        { "name": "masks_dirname", "kind": "string", "required": false, "flag": "--masks-dirname" },
        { "name": "force", "kind": "string", "required": false, "flag": "--force" },
        { "name": "year", "kind": "string", "required": false, "flag": "--year" }
      ],
      "effects": {
        "writes": [
          {
            "flag": "--out",
            "kind": "dir",
            "scope": "tree",
            "description": "Writes prepared segmentation dataset layout under --out (manifest + optional symlinks/copies)."
          }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "dataset_root", "kind": "dir", "description": "Prepared output root created at --out." },
        { "name": "dataset_descriptor", "kind": "file", "description": "dataset.json manifest.", "default": "<out>/dataset.json" }
      ],
      "examples": [
        {
          "description": "Create a manifest-only dataset.json (no copying).",
          "command": "python3 tools/prepare_voc_seg.py --voc-root /path/to/VOCdevkit/VOC2012 --split train --out data/voc_seg --mode manifest"
        }
      ]
    },
    {
      "id": "prepare_ade20k_seg",
      "entrypoint": "tools/prepare_ade20k_seg.py",
      "runner": "python3",
      "summary": "Prepare ADE20K semantic segmentation layout + dataset.json manifest.",
      "tags": ["dataset", "ade20k", "segmentation"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "inputs": [
        { "name": "ade20k_root", "kind": "dir", "required": true, "flag": "--ade20k-root" },
        { "name": "out", "kind": "dir", "required": true, "flag": "--out" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split", "default": "train" },
        { "name": "ignore_index", "kind": "number", "required": false, "flag": "--ignore-index" },
        { "name": "mode", "kind": "string", "required": false, "flag": "--mode" },
        { "name": "force", "kind": "string", "required": false, "flag": "--force" }
      ],
      "effects": {
        "writes": [
          {
            "flag": "--out",
            "kind": "dir",
            "scope": "tree",
            "description": "Writes prepared segmentation dataset layout under --out (manifest + optional symlinks/copies)."
          }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "dataset_root", "kind": "dir", "description": "Prepared output root created at --out." },
        { "name": "dataset_descriptor", "kind": "file", "description": "dataset.json manifest.", "default": "<out>/dataset.json" }
      ],
      "examples": [
        {
          "description": "Create a manifest-only dataset.json (no copying).",
          "command": "python3 tools/prepare_ade20k_seg.py --ade20k-root /path/to/ADEChallengeData2016 --split train --out data/ade20k_seg --mode manifest"
        }
      ]
    },
    {
      "id": "build_manifest",
      "entrypoint": "tools/build_manifest.py",
      "runner": "python3",
      "summary": "Build a dataset manifest for data/coco128 (writes reports/manifest.json).",
      "tags": ["dataset"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "inputs": [],
      "effects": {
        "writes": [],
        "fixed_writes": [
          {
            "path": "reports/manifest.json",
            "kind": "file",
            "scope": "path",
            "description": "Writes a dataset manifest JSON."
          }
        ]
      },
      "outputs": [
        { "name": "manifest_json", "kind": "file", "default": "reports/manifest.json" }
      ],
      "examples": [
        { "description": "Emit manifest JSON for coco128.", "command": "python3 tools/build_manifest.py" }
      ]
    },
    {
      "id": "export_predictions",
      "entrypoint": "tools/export_predictions.py",
      "runner": "python3",
      "summary": "Run an adapter to export YOLOZU predictions JSON (dummy or rtdetr_pose).",
      "tags": ["predictions", "adapter"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "produces": ["predictions_json"] },
      "contract_outputs": { "predictions_json": "predictions_json" },
      "inputs": [
        { "name": "adapter", "kind": "string", "required": false, "flag": "--adapter", "default": "dummy" },
        { "name": "dataset", "kind": "dir", "required": false, "flag": "--dataset", "default": "data/coco128" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/predictions.json" },
        { "name": "wrap", "kind": "string", "required": false, "flag": "--wrap" },
        { "name": "config", "kind": "file", "required": false, "flag": "--config" },
        { "name": "device", "kind": "string", "required": false, "flag": "--device" },
        { "name": "image_size", "kind": "number", "required": false, "flag": "--image-size" },
        { "name": "score_threshold", "kind": "number", "required": false, "flag": "--score-threshold" },
        { "name": "max_detections", "kind": "number", "required": false, "flag": "--max-detections" },
        { "name": "checkpoint", "kind": "file", "required": false, "flag": "--checkpoint" },
        { "name": "lora_r", "kind": "number", "required": false, "flag": "--lora-r" },
        { "name": "lora_alpha", "kind": "number", "required": false, "flag": "--lora-alpha" },
        { "name": "lora_dropout", "kind": "number", "required": false, "flag": "--lora-dropout" },
        { "name": "lora_target", "kind": "string", "required": false, "flag": "--lora-target" },
        { "name": "lora_freeze_base", "kind": "string", "required": false, "flag": "--lora-freeze-base" },
        { "name": "no_lora_freeze_base", "kind": "string", "required": false, "flag": "--no-lora-freeze-base" },
        { "name": "lora_train_bias", "kind": "string", "required": false, "flag": "--lora-train-bias" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split" },
        { "name": "tta", "kind": "string", "required": false, "flag": "--tta" },
        { "name": "tta_seed", "kind": "number", "required": false, "flag": "--tta-seed" },
        { "name": "tta_flip_prob", "kind": "number", "required": false, "flag": "--tta-flip-prob" },
        { "name": "tta_norm_only", "kind": "string", "required": false, "flag": "--tta-norm-only" },
        { "name": "tta_log_out", "kind": "file", "required": false, "flag": "--tta-log-out" },
        { "name": "ttt", "kind": "string", "required": false, "flag": "--ttt" },
        { "name": "ttt_preset", "kind": "string", "required": false, "flag": "--ttt-preset" },
        { "name": "ttt_method", "kind": "string", "required": false, "flag": "--ttt-method" },
        { "name": "ttt_reset", "kind": "string", "required": false, "flag": "--ttt-reset" },
        { "name": "ttt_steps", "kind": "number", "required": false, "flag": "--ttt-steps" },
        { "name": "ttt_batch_size", "kind": "number", "required": false, "flag": "--ttt-batch-size" },
        { "name": "ttt_lr", "kind": "number", "required": false, "flag": "--ttt-lr" },
        { "name": "ttt_stop_on_non_finite", "kind": "string", "required": false, "flag": "--ttt-stop-on-non-finite" },
        { "name": "no_ttt_stop_on_non_finite", "kind": "string", "required": false, "flag": "--no-ttt-stop-on-non-finite" },
        { "name": "ttt_rollback_on_stop", "kind": "string", "required": false, "flag": "--ttt-rollback-on-stop" },
        { "name": "no_ttt_rollback_on_stop", "kind": "string", "required": false, "flag": "--no-ttt-rollback-on-stop" },
        { "name": "ttt_seed", "kind": "number", "required": false, "flag": "--ttt-seed" },
        { "name": "ttt_max_update_norm", "kind": "number", "required": false, "flag": "--ttt-max-update-norm" },
        { "name": "ttt_max_total_update_norm", "kind": "number", "required": false, "flag": "--ttt-max-total-update-norm" },
        { "name": "ttt_max_loss_ratio", "kind": "number", "required": false, "flag": "--ttt-max-loss-ratio" },
        { "name": "ttt_max_loss_increase", "kind": "number", "required": false, "flag": "--ttt-max-loss-increase" },
        { "name": "ttt_update_filter", "kind": "string", "required": false, "flag": "--ttt-update-filter" },
        { "name": "ttt_include", "kind": "string", "required": false, "flag": "--ttt-include" },
        { "name": "ttt_exclude", "kind": "string", "required": false, "flag": "--ttt-exclude" },
        { "name": "ttt_log_out", "kind": "file", "required": false, "flag": "--ttt-log-out" },
        { "name": "ttt_patch_size", "kind": "number", "required": false, "flag": "--ttt-patch-size" },
        { "name": "ttt_mask_prob", "kind": "number", "required": false, "flag": "--ttt-mask-prob" },
        { "name": "ttt_mask_value", "kind": "number", "required": false, "flag": "--ttt-mask-value" },
        { "name": "ttt_max_batches", "kind": "number", "required": false, "flag": "--ttt-max-batches" },
        { "name": "ttt_max_grad_norm", "kind": "number", "required": false, "flag": "--ttt-max-grad-norm" },
        { "name": "ttt_cotta_ema_momentum", "kind": "number", "required": false, "flag": "--ttt-cotta-ema-momentum" },
        { "name": "ttt_cotta_augmentations", "kind": "string", "required": false, "flag": "--ttt-cotta-augmentations" },
        { "name": "ttt_cotta_aggregation", "kind": "string", "required": false, "flag": "--ttt-cotta-aggregation" },
        { "name": "ttt_cotta_restore_prob", "kind": "number", "required": false, "flag": "--ttt-cotta-restore-prob" },
        { "name": "ttt_cotta_restore_interval", "kind": "number", "required": false, "flag": "--ttt-cotta-restore-interval" },
        { "name": "ttt_eata_conf_min", "kind": "number", "required": false, "flag": "--ttt-eata-conf-min" },
        { "name": "ttt_eata_entropy_min", "kind": "number", "required": false, "flag": "--ttt-eata-entropy-min" },
        { "name": "ttt_eata_entropy_max", "kind": "number", "required": false, "flag": "--ttt-eata-entropy-max" },
        { "name": "ttt_eata_min_valid_dets", "kind": "number", "required": false, "flag": "--ttt-eata-min-valid-dets" },
        { "name": "ttt_eata_anchor_lambda", "kind": "number", "required": false, "flag": "--ttt-eata-anchor-lambda" },
        { "name": "ttt_eata_selected_ratio_min", "kind": "number", "required": false, "flag": "--ttt-eata-selected-ratio-min" },
        { "name": "ttt_eata_max_skip_streak", "kind": "number", "required": false, "flag": "--ttt-eata-max-skip-streak" },
        { "name": "ttt_sar_rho", "kind": "number", "required": false, "flag": "--ttt-sar-rho" },
        { "name": "ttt_sar_adaptive", "kind": "string", "required": false, "flag": "--ttt-sar-adaptive" },
        { "name": "no_ttt_sar_adaptive", "kind": "string", "required": false, "flag": "--no-ttt-sar-adaptive" },
        { "name": "ttt_sar_first_step_scale", "kind": "number", "required": false, "flag": "--ttt-sar-first-step-scale" }
      ],
      "effects": {
        "writes": [
          {
            "flag": "--output",
            "kind": "file",
            "scope": "path",
            "description": "Writes predictions JSON."
          },
          {
            "flag": "--tta-log-out",
            "kind": "file",
            "scope": "path",
            "description": "Optional TTA log JSON output."
          },
          {
            "flag": "--ttt-log-out",
            "kind": "file",
            "scope": "path",
            "description": "Optional TTT log JSON output."
          }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "predictions_json", "kind": "file", "default": "reports/predictions.json" }],
      "examples": [
        {
          "description": "Export dummy predictions (schema smoke).",
          "command": "python3 tools/export_predictions.py --adapter dummy --dataset data/coco128 --wrap --output reports/predictions_dummy.json"
        }
      ],
      "docs": ["docs/real_model_interface.md"]
    },
    {
      "id": "yolozu",
      "entrypoint": "tools/yolozu.py",
      "runner": "python3",
      "summary": "Unified CLI: doctor/import + export (dummy/torch/onnxrt/trt) + predict-images (folder→JSON+overlays+HTML) + eval-instance-seg + long-tail calibrate/eval + sweep wrapper + fingerprinted caching.",
      "tags": ["cli", "predictions", "diagnostics", "report", "sweep", "long_tail", "import"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "produces": ["predictions_json"] },
      "inputs": [
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/predictions.json" },
        { "name": "cache_dir", "kind": "dir", "required": false, "flag": "--cache-dir", "default": "runs/yolozu_runs" },
        { "name": "tta_log_out", "kind": "file", "required": false, "flag": "--tta-log-out", "default": null },
        { "name": "ttt_log_out", "kind": "file", "required": false, "flag": "--ttt-log-out", "default": null },
        { "name": "run_dir", "kind": "dir", "required": false, "flag": "--run-dir", "default": null },
        { "name": "overlays_dir", "kind": "dir", "required": false, "flag": "--overlays-dir", "default": "reports/overlays" },
        { "name": "html", "kind": "file", "required": false, "flag": "--html", "default": "reports/predict_images.html" },
        { "name": "allow_gpu", "kind": "string", "required": false, "flag": "--allow-gpu" },
        { "name": "allow_network", "kind": "string", "required": false, "flag": "--allow-network" },
        { "name": "allow_rgb_masks", "kind": "string", "required": false, "flag": "--allow-rgb-masks" },
        { "name": "allow_undeclared_effects", "kind": "string", "required": false, "flag": "--allow-undeclared-effects" },
        { "name": "allow_unknown_flags", "kind": "string", "required": false, "flag": "--allow-unknown-flags" },
        { "name": "allow_unsafe_paths", "kind": "string", "required": false, "flag": "--allow-unsafe-paths" },
        { "name": "allow_write_root", "kind": "string", "required": false, "flag": "--allow-write-root" },
        { "name": "alpha", "kind": "number", "required": false, "flag": "--alpha" },
        { "name": "backend", "kind": "string", "required": false, "flag": "--backend" },
        { "name": "boxes_scale", "kind": "string", "required": false, "flag": "--boxes-scale" },
        { "name": "cache", "kind": "string", "required": false, "flag": "--cache" },
        { "name": "calibration_bins", "kind": "number", "required": false, "flag": "--calibration-bins" },
        { "name": "calibration_iou", "kind": "number", "required": false, "flag": "--calibration-iou" },
        { "name": "checkpoint", "kind": "file", "required": false, "flag": "--checkpoint" },
        { "name": "class_balanced_beta", "kind": "number", "required": false, "flag": "--class-balanced-beta" },
        { "name": "classes", "kind": "file", "required": false, "flag": "--classes" },
        { "name": "combined_output", "kind": "string", "required": false, "flag": "--combined-output" },
        { "name": "config", "kind": "file", "required": false, "flag": "--config" },
        { "name": "contract", "kind": "string", "required": false, "flag": "--contract" },
        { "name": "dataset", "kind": "dir", "required": false, "flag": "--dataset" },
        { "name": "device", "kind": "string", "required": false, "flag": "--device" },
        { "name": "diag_iou", "kind": "number", "required": false, "flag": "--diag-iou" },
        { "name": "dry_run", "kind": "string", "required": false, "flag": "--dry-run" },
        { "name": "fit_iou", "kind": "number", "required": false, "flag": "--fit-iou" },
        { "name": "fit_max_detections", "kind": "number", "required": false, "flag": "--fit-max-detections" },
        { "name": "fit_temperature", "kind": "number", "required": false, "flag": "--fit-temperature" },
        { "name": "focal_gamma", "kind": "number", "required": false, "flag": "--focal-gamma" },
        { "name": "force", "kind": "string", "required": false, "flag": "--force" },
        { "name": "gamma", "kind": "number", "required": false, "flag": "--gamma" },
        { "name": "glob", "kind": "string", "required": false, "flag": "--glob" },
        { "name": "head_fraction", "kind": "number", "required": false, "flag": "--head-fraction" },
        { "name": "help", "kind": "string", "required": false, "flag": "--help" },
        { "name": "image_size", "kind": "number", "required": false, "flag": "--image-size" },
        { "name": "input_dir", "kind": "dir", "required": false, "flag": "--input-dir" },
        { "name": "input_name", "kind": "string", "required": false, "flag": "--input-name" },
        { "name": "json", "kind": "string", "required": false, "flag": "--json" },
        { "name": "iou_threshold", "kind": "number", "required": false, "flag": "--iou-threshold" },
        { "name": "keep_per_image", "kind": "string", "required": false, "flag": "--keep-per-image" },
        { "name": "kp_line", "kind": "number", "required": false, "flag": "--kp-line" },
        { "name": "kp_radius", "kind": "number", "required": false, "flag": "--kp-radius" },
        { "name": "ldam_margin", "kind": "number", "required": false, "flag": "--ldam-margin" },
        { "name": "logit_adjustment_tau", "kind": "number", "required": false, "flag": "--logit-adjustment-tau" },
        { "name": "lora_alpha", "kind": "number", "required": false, "flag": "--lora-alpha" },
        { "name": "lora_dropout", "kind": "number", "required": false, "flag": "--lora-dropout" },
        { "name": "lora_freeze_base", "kind": "string", "required": false, "flag": "--lora-freeze-base" },
        { "name": "lora_r", "kind": "number", "required": false, "flag": "--lora-r" },
        { "name": "lora_target", "kind": "string", "required": false, "flag": "--lora-target" },
        { "name": "lora_train_bias", "kind": "string", "required": false, "flag": "--lora-train-bias" },
        { "name": "lort_tau", "kind": "number", "required": false, "flag": "--lort-tau" },
        { "name": "loss_plugin", "kind": "string", "required": false, "flag": "--loss-plugin" },
        { "name": "max_detections", "kind": "number", "required": false, "flag": "--max-detections" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "max_overlays", "kind": "number", "required": false, "flag": "--max-overlays" },
        { "name": "max_runs", "kind": "number", "required": false, "flag": "--max-runs" },
        { "name": "max_score", "kind": "number", "required": false, "flag": "--max-score" },
        { "name": "medium_fraction", "kind": "number", "required": false, "flag": "--medium-fraction" },
        { "name": "method", "kind": "string", "required": false, "flag": "--method" },
        { "name": "metric", "kind": "string", "required": false, "flag": "--metric" },
        { "name": "metric_key", "kind": "string", "required": false, "flag": "--metric-key" },
        { "name": "min_score", "kind": "number", "required": false, "flag": "--min-score" },
        { "name": "model", "kind": "string", "required": false, "flag": "--model" },
        { "name": "no_lora_freeze_base", "kind": "string", "required": false, "flag": "--no-lora-freeze-base" },
        { "name": "no_ttt_rollback_on_stop", "kind": "string", "required": false, "flag": "--no-ttt-rollback-on-stop" },
        { "name": "no_ttt_sar_adaptive", "kind": "string", "required": false, "flag": "--no-ttt-sar-adaptive" },
        { "name": "no_ttt_stop_on_non_finite", "kind": "string", "required": false, "flag": "--no-ttt-stop-on-non-finite" },
        { "name": "notes", "kind": "string", "required": false, "flag": "--notes" },
        { "name": "oks", "kind": "string", "required": false, "flag": "--oks" },
        { "name": "oks_max_dets", "kind": "number", "required": false, "flag": "--oks-max-dets" },
        { "name": "oks_sigmas", "kind": "string", "required": false, "flag": "--oks-sigmas" },
        { "name": "oks_sigmas_file", "kind": "file", "required": false, "flag": "--oks-sigmas-file" },
        { "name": "output_report", "kind": "file", "required": false, "flag": "--output-report" },
        { "name": "overlay_alpha", "kind": "number", "required": false, "flag": "--overlay-alpha" },
        { "name": "overlay_max_size", "kind": "number", "required": false, "flag": "--overlay-max-size" },
        { "name": "overlay_sort", "kind": "string", "required": false, "flag": "--overlay-sort" },
        { "name": "pck_threshold", "kind": "number", "required": false, "flag": "--pck-threshold" },
        { "name": "per_image_limit", "kind": "number", "required": false, "flag": "--per-image-limit" },
        { "name": "pred_root", "kind": "dir", "required": false, "flag": "--pred-root" },
        { "name": "predictions", "kind": "file", "required": false, "flag": "--predictions" },
        { "name": "rebalance_sampler", "kind": "string", "required": false, "flag": "--rebalance-sampler" },
        { "name": "replay_fraction", "kind": "number", "required": false, "flag": "--replay-fraction" },
        { "name": "replay_per_task_cap", "kind": "number", "required": false, "flag": "--replay-per-task-cap" },
        { "name": "replay_size", "kind": "number", "required": false, "flag": "--replay-size" },
        { "name": "resume", "kind": "string", "required": false, "flag": "--resume" },
        { "name": "run_json", "kind": "file", "required": false, "flag": "--run-json" },
        { "name": "score_threshold", "kind": "number", "required": false, "flag": "--score-threshold" },
        { "name": "seed", "kind": "number", "required": false, "flag": "--seed" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split" },
        { "name": "stage1_epochs", "kind": "number", "required": false, "flag": "--stage1-epochs" },
        { "name": "stage2_epochs", "kind": "number", "required": false, "flag": "--stage2-epochs" },
        { "name": "stats_in", "kind": "file", "required": false, "flag": "--stats-in" },
        { "name": "stats_out", "kind": "file", "required": false, "flag": "--stats-out" },
        { "name": "strength", "kind": "number", "required": false, "flag": "--strength" },
        { "name": "success_rot_deg", "kind": "number", "required": false, "flag": "--success-rot-deg" },
        { "name": "success_trans", "kind": "number", "required": false, "flag": "--success-trans" },
        { "name": "task", "kind": "string", "required": false, "flag": "--task" },
        { "name": "tau", "kind": "number", "required": false, "flag": "--tau" },
        { "name": "temperature", "kind": "number", "required": false, "flag": "--temperature" },
        { "name": "temperature_grid", "kind": "string", "required": false, "flag": "--temperature-grid" },
        { "name": "tag", "kind": "string", "required": false, "flag": "--tag" },
        { "name": "title", "kind": "string", "required": false, "flag": "--title" },
        { "name": "topk", "kind": "number", "required": false, "flag": "--topk" },
        { "name": "tta", "kind": "string", "required": false, "flag": "--tta" },
        { "name": "tta_flip_prob", "kind": "number", "required": false, "flag": "--tta-flip-prob" },
        { "name": "tta_norm_only", "kind": "string", "required": false, "flag": "--tta-norm-only" },
        { "name": "tta_seed", "kind": "number", "required": false, "flag": "--tta-seed" },
        { "name": "ttt", "kind": "string", "required": false, "flag": "--ttt" },
        { "name": "ttt_batch_size", "kind": "number", "required": false, "flag": "--ttt-batch-size" },
        { "name": "ttt_cotta_aggregation", "kind": "string", "required": false, "flag": "--ttt-cotta-aggregation" },
        { "name": "ttt_cotta_augmentations", "kind": "string", "required": false, "flag": "--ttt-cotta-augmentations" },
        { "name": "ttt_cotta_ema_momentum", "kind": "number", "required": false, "flag": "--ttt-cotta-ema-momentum" },
        { "name": "ttt_cotta_restore_interval", "kind": "number", "required": false, "flag": "--ttt-cotta-restore-interval" },
        { "name": "ttt_cotta_restore_prob", "kind": "number", "required": false, "flag": "--ttt-cotta-restore-prob" },
        { "name": "ttt_eata_anchor_lambda", "kind": "number", "required": false, "flag": "--ttt-eata-anchor-lambda" },
        { "name": "ttt_eata_conf_min", "kind": "number", "required": false, "flag": "--ttt-eata-conf-min" },
        { "name": "ttt_eata_entropy_max", "kind": "number", "required": false, "flag": "--ttt-eata-entropy-max" },
        { "name": "ttt_eata_entropy_min", "kind": "number", "required": false, "flag": "--ttt-eata-entropy-min" },
        { "name": "ttt_eata_max_skip_streak", "kind": "number", "required": false, "flag": "--ttt-eata-max-skip-streak" },
        { "name": "ttt_eata_min_valid_dets", "kind": "number", "required": false, "flag": "--ttt-eata-min-valid-dets" },
        { "name": "ttt_eata_selected_ratio_min", "kind": "number", "required": false, "flag": "--ttt-eata-selected-ratio-min" },
        { "name": "ttt_exclude", "kind": "string", "required": false, "flag": "--ttt-exclude" },
        { "name": "ttt_include", "kind": "string", "required": false, "flag": "--ttt-include" },
        { "name": "ttt_lr", "kind": "number", "required": false, "flag": "--ttt-lr" },
        { "name": "ttt_mask_prob", "kind": "number", "required": false, "flag": "--ttt-mask-prob" },
        { "name": "ttt_mask_value", "kind": "number", "required": false, "flag": "--ttt-mask-value" },
        { "name": "ttt_max_batches", "kind": "number", "required": false, "flag": "--ttt-max-batches" },
        { "name": "ttt_max_grad_norm", "kind": "number", "required": false, "flag": "--ttt-max-grad-norm" },
        { "name": "ttt_max_loss_increase", "kind": "number", "required": false, "flag": "--ttt-max-loss-increase" },
        { "name": "ttt_max_loss_ratio", "kind": "number", "required": false, "flag": "--ttt-max-loss-ratio" },
        { "name": "ttt_max_total_update_norm", "kind": "number", "required": false, "flag": "--ttt-max-total-update-norm" },
        { "name": "ttt_max_update_norm", "kind": "number", "required": false, "flag": "--ttt-max-update-norm" },
        { "name": "ttt_method", "kind": "string", "required": false, "flag": "--ttt-method" },
        { "name": "ttt_patch_size", "kind": "number", "required": false, "flag": "--ttt-patch-size" },
        { "name": "ttt_preset", "kind": "string", "required": false, "flag": "--ttt-preset" },
        { "name": "ttt_reset", "kind": "string", "required": false, "flag": "--ttt-reset" },
        { "name": "ttt_rollback_on_stop", "kind": "string", "required": false, "flag": "--ttt-rollback-on-stop" },
        { "name": "ttt_sar_adaptive", "kind": "string", "required": false, "flag": "--ttt-sar-adaptive" },
        { "name": "ttt_sar_first_step_scale", "kind": "number", "required": false, "flag": "--ttt-sar-first-step-scale" },
        { "name": "ttt_sar_rho", "kind": "number", "required": false, "flag": "--ttt-sar-rho" },
        { "name": "ttt_seed", "kind": "number", "required": false, "flag": "--ttt-seed" },
        { "name": "ttt_steps", "kind": "number", "required": false, "flag": "--ttt-steps" },
        { "name": "ttt_stop_on_non_finite", "kind": "string", "required": false, "flag": "--ttt-stop-on-non-finite" },
        { "name": "ttt_update_filter", "kind": "string", "required": false, "flag": "--ttt-update-filter" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Writes JSON output (predictions / reports depending on subcommand)." },
          { "flag": "--cache-dir", "kind": "dir", "scope": "tree", "description": "Writes fingerprinted cache artifacts under --cache-dir." },
          { "flag": "--tta-log-out", "kind": "file", "scope": "path", "description": "Optional TTA log JSON output." },
          { "flag": "--ttt-log-out", "kind": "file", "scope": "path", "description": "Optional TTT log JSON output." },
          { "flag": "--run-dir", "kind": "dir", "scope": "tree", "description": "Optional run directory for continual runners." },
          { "flag": "--overlays-dir", "kind": "dir", "scope": "tree", "description": "Optional overlay image directory." },
          { "flag": "--html", "kind": "file", "scope": "path", "description": "Optional HTML report output." }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "output_json", "kind": "file", "description": "Primary output artifact controlled by --output (subcommand-dependent)." },
        { "name": "cache_dir", "kind": "dir", "description": "Cache artifacts directory when --cache-dir is used." },
        { "name": "html", "kind": "file", "description": "Optional HTML output when --html is used." },
        { "name": "overlays_dir", "kind": "dir", "description": "Optional overlay directory when --overlays-dir is used." }
      ],
      "examples": [
        { "description": "Doctor report.", "command": "python3 tools/yolozu.py doctor --output reports/doctor.json" },
        {
          "description": "Doctor import auto-detect (config).",
          "command": "python3 -m yolozu doctor import --config-from auto --args /path/to/args.yaml --output -"
        },
        {
          "description": "Export dummy predictions with run meta.",
          "command": "python3 tools/yolozu.py export --backend dummy --dataset data/coco128 --max-images 5 --output reports/predictions_dummy_run.json"
        },
        {
          "description": "Folder input → predictions JSON + overlays + HTML (dummy backend).",
          "command": "python3 tools/yolozu.py predict-images --backend dummy --input-dir data/coco128/images/val2017 --max-images 5 --output reports/predict_images_dummy.json --overlays-dir reports/overlays_dummy --html reports/predict_images_dummy.html"
        },
        {
          "description": "Evaluate instance-seg demo predictions (mask mAP) with HTML overlays.",
          "command": "python3 tools/yolozu.py eval-instance-seg --dataset examples/instance_seg_demo/dataset --split val2017 --predictions examples/instance_seg_demo/predictions/instance_seg_predictions.json --pred-root examples/instance_seg_demo/predictions --classes examples/instance_seg_demo/classes.txt --html reports/instance_seg_demo_eval.html --overlays-dir reports/instance_seg_demo_overlays --max-overlays 10"
        },
        {
          "description": "Run a sweep config (dry-run).",
          "command": "python3 tools/yolozu.py sweep --config docs/hpo_sweep_example.json --dry-run"
        },
        {
          "description": "Long-tail post-hoc calibration + standardized eval.",
          "command": "python3 tools/yolozu.py calibrate --method fracal --dataset data/coco128 --predictions reports/predictions.json --output reports/predictions_calibrated.json && python3 tools/yolozu.py eval-long-tail --dataset data/coco128 --predictions reports/predictions_calibrated.json --output reports/long_tail_eval.json"
        },
        {
          "description": "Train import preview with auto framework detection.",
          "command": "python3 -m yolozu train --import auto --cfg /path/to/args_or_config.{yaml,py} --resolved-config-out reports/train_config_resolved_import.json"
        }
      ],
      "docs": ["docs/tools_index.md"]
    },
    {
      "id": "validate_predictions",
      "entrypoint": "tools/validate_predictions.py",
      "runner": "python3",
      "summary": "Validate YOLOZU predictions JSON schema (permissive by default; strict optional).",
      "tags": ["predictions", "validation"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"] },
      "inputs": [
        { "name": "predictions", "kind": "file", "required": true, "description": "Predictions JSON path." },
        { "name": "strict", "kind": "string", "required": false, "flag": "--strict" }
      ],
      "effects": { "writes": [], "fixed_writes": [] },
      "outputs": [{ "name": "stdout", "kind": "stdout", "description": "OK/WARN lines." }],
      "examples": [
        { "description": "Strict schema validation.", "command": "python3 tools/validate_predictions.py reports/predictions.json --strict" }
      ]
    },
    {
      "id": "validate_segmentation_predictions",
      "entrypoint": "tools/validate_segmentation_predictions.py",
      "runner": "python3",
      "summary": "Validate YOLOZU segmentation predictions JSON (id→mask path mapping; meta optional).",
      "tags": ["segmentation", "predictions", "validation"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["segmentation_predictions_json"] },
      "inputs": [{ "name": "predictions", "kind": "file", "required": true, "description": "Segmentation predictions JSON path." }],
      "effects": { "writes": [], "fixed_writes": [] },
      "outputs": [{ "name": "stdout", "kind": "stdout", "description": "OK/WARN lines." }],
      "examples": [
        {
          "description": "Validate a segmentation predictions artifact.",
          "command": "python3 tools/validate_segmentation_predictions.py reports/seg_predictions.json"
        }
      ]
    },
    {
      "id": "validate_instance_segmentation_predictions",
      "entrypoint": "tools/validate_instance_segmentation_predictions.py",
      "runner": "python3",
      "summary": "Validate YOLOZU instance segmentation predictions JSON (per-image instances; PNG masks).",
      "tags": ["instance_segmentation", "predictions", "validation"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["instance_segmentation_predictions_json"] },
      "inputs": [{ "name": "predictions", "kind": "file", "required": true, "description": "Instance segmentation predictions JSON path." }],
      "effects": { "writes": [], "fixed_writes": [] },
      "outputs": [{ "name": "stdout", "kind": "stdout", "description": "OK/WARN lines." }],
      "examples": [
        {
          "description": "Validate an instance segmentation predictions artifact.",
          "command": "python3 tools/validate_instance_segmentation_predictions.py reports/instance_seg_predictions.json"
        }
      ]
    },
    {
      "id": "validate_run_meta",
      "entrypoint": "tools/validate_run_meta.py",
      "runner": "python3",
      "summary": "Validate run_meta.json contract (git SHA, dependency lock, preprocess, hardware/runtime, command).",
      "tags": ["run_meta", "validation", "repro"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "inputs": [
        { "name": "run_meta", "kind": "file", "required": true, "description": "Path to runs/<run_id>/reports/run_meta.json." },
        { "name": "allow_missing_git_sha", "kind": "string", "required": false, "flag": "--allow-missing-git-sha" }
      ],
      "effects": { "writes": [], "fixed_writes": [] },
      "outputs": [{ "name": "stdout", "kind": "stdout", "description": "OK line or validation error." }],
      "examples": [
        {
          "description": "Validate contracted run metadata.",
          "command": "python3 tools/validate_run_meta.py runs/ci_smoke/reports/run_meta.json"
        }
      ],
      "docs": ["docs/run_contract.md"]
    },
    {
      "id": "normalize_predictions",
      "entrypoint": "tools/normalize_predictions.py",
      "runner": "python3",
      "summary": "Normalize prediction class ids (category_id↔class_id) and optionally wrap with meta.",
      "tags": ["predictions", "transform"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"], "produces": ["predictions_json"] },
      "contract_outputs": { "predictions_json": "predictions_json" },
      "inputs": [
        { "name": "input", "kind": "file", "required": true, "flag": "--input" },
        { "name": "output", "kind": "file", "required": true, "flag": "--output" },
        { "name": "classes", "kind": "file", "required": false, "flag": "--classes" },
        { "name": "assume_class_id_is_category_id", "kind": "string", "required": false, "flag": "--assume-class-id-is-category-id" },
        { "name": "wrap", "kind": "string", "required": false, "flag": "--wrap" }
      ],
      "effects": {
        "writes": [
          {
            "flag": "--output",
            "kind": "file",
            "scope": "path",
            "description": "Writes normalized predictions JSON."
          }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "predictions_json", "kind": "file", "description": "Normalized predictions JSON at --output." }],
      "examples": [
        {
          "description": "Remap COCO category_id -> contiguous class_id and wrap output.",
          "command": "python3 tools/normalize_predictions.py --input reports/predictions.json --output reports/predictions_norm.json --classes data/coco-yolo/labels/val2017/classes.json --wrap"
        }
      ]
    },
    {
      "id": "eval_segmentation",
      "entrypoint": "tools/eval_segmentation.py",
      "runner": "python3",
      "summary": "Evaluate semantic segmentation predictions (mIoU / per-class IoU) with ignore_index support and optional HTML/overlays.",
      "tags": ["eval", "segmentation"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": {
        "consumes": ["seg_dataset_json", "segmentation_predictions_json"],
        "produces": ["seg_eval_report_json"]
      },
      "contract_outputs": { "seg_eval_report_json": "seg_eval_json" },
      "inputs": [
        { "name": "dataset_json", "kind": "file", "required": true, "flag": "--dataset-json" },
        { "name": "predictions", "kind": "file", "required": true, "flag": "--predictions" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/seg_eval.json" },
        { "name": "html", "kind": "file", "required": false, "flag": "--html" },
        { "name": "overlays_dir", "kind": "dir", "required": false, "flag": "--overlays-dir" },
        { "name": "overlay_alpha", "kind": "number", "required": false, "flag": "--overlay-alpha" },
        { "name": "overlay_max_size", "kind": "number", "required": false, "flag": "--overlay-max-size" },
        { "name": "max_overlays", "kind": "number", "required": false, "flag": "--max-overlays" },
        { "name": "pred_root", "kind": "dir", "required": false, "flag": "--pred-root" },
        { "name": "ignore_index", "kind": "number", "required": false, "flag": "--ignore-index" },
        { "name": "num_classes", "kind": "number", "required": false, "flag": "--num-classes" },
        { "name": "max_samples", "kind": "number", "required": false, "flag": "--max-samples" },
        { "name": "allow_gt_out_of_range", "kind": "string", "required": false, "flag": "--allow-gt-out-of-range" },
        { "name": "allow_rgb_masks", "kind": "string", "required": false, "flag": "--allow-rgb-masks" },
        { "name": "miou_ignore_background", "kind": "string", "required": false, "flag": "--miou-ignore-background" },
        { "name": "skip_missing_pred", "kind": "string", "required": false, "flag": "--skip-missing-pred" }
      ],
      "effects": {
        "writes": [
          {
            "flag": "--output",
            "kind": "file",
            "scope": "path",
            "description": "Writes segmentation evaluation JSON report."
          },
          {
            "flag": "--html",
            "kind": "file",
            "scope": "path",
            "description": "Optional HTML report output."
          },
          {
            "flag": "--overlays-dir",
            "kind": "dir",
            "scope": "tree",
            "description": "Optional overlay image outputs."
          }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "seg_eval_json", "kind": "file", "default": "reports/seg_eval.json" }],
      "examples": [
        {
          "description": "Evaluate segmentation predictions and write a JSON report.",
          "command": "python3 tools/eval_segmentation.py --dataset-json data/cityscapes_seg/dataset.json --predictions reports/seg_predictions.json --output reports/seg_eval.json"
        }
      ]
    },
    {
      "id": "eval_instance_segmentation",
      "entrypoint": "tools/eval_instance_segmentation.py",
      "runner": "python3",
      "summary": "Evaluate instance segmentation predictions (mask mAP) from binary PNG masks with optional HTML/overlays.",
      "tags": ["eval", "instance_segmentation", "segmentation"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": {
        "consumes": ["instance_segmentation_predictions_json"],
        "produces": ["instance_seg_eval_report_json"]
      },
      "contract_outputs": { "instance_seg_eval_report_json": "instance_seg_eval_json" },
      "inputs": [
        { "name": "dataset", "kind": "dir", "required": true, "flag": "--dataset" },
        { "name": "predictions", "kind": "file", "required": true, "flag": "--predictions" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/instance_seg_eval.json" },
        { "name": "html", "kind": "file", "required": false, "flag": "--html", "default": null },
        { "name": "overlays_dir", "kind": "dir", "required": false, "flag": "--overlays-dir", "default": null },
        { "name": "split", "kind": "string", "required": false, "flag": "--split" },
        { "name": "title", "kind": "string", "required": false, "flag": "--title" },
        { "name": "pred_root", "kind": "dir", "required": false, "flag": "--pred-root" },
        { "name": "classes", "kind": "file", "required": false, "flag": "--classes" },
        { "name": "allow_rgb_masks", "kind": "string", "required": false, "flag": "--allow-rgb-masks" },
        { "name": "diag_iou", "kind": "number", "required": false, "flag": "--diag-iou" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "min_score", "kind": "number", "required": false, "flag": "--min-score" },
        { "name": "per_image_limit", "kind": "number", "required": false, "flag": "--per-image-limit" },
        { "name": "max_overlays", "kind": "number", "required": false, "flag": "--max-overlays" },
        { "name": "overlay_alpha", "kind": "number", "required": false, "flag": "--overlay-alpha" },
        { "name": "overlay_max_size", "kind": "number", "required": false, "flag": "--overlay-max-size" },
        { "name": "overlay_sort", "kind": "string", "required": false, "flag": "--overlay-sort" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Writes instance segmentation evaluation JSON report." },
          { "flag": "--html", "kind": "file", "scope": "path", "description": "Optional HTML report output." },
          { "flag": "--overlays-dir", "kind": "dir", "scope": "tree", "description": "Optional overlay image outputs." }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "instance_seg_eval_json", "kind": "file", "default": "reports/instance_seg_eval.json" }],
      "examples": [
        {
          "description": "Evaluate instance segmentation predictions and write a JSON report.",
          "command": "python3 tools/eval_instance_segmentation.py --dataset data/coco-yolo --predictions reports/instance_seg_predictions.json --output reports/instance_seg_eval.json"
        }
      ]
    },
    {
      "id": "eval_keypoints",
      "entrypoint": "tools/eval_keypoints.py",
      "runner": "python3",
      "summary": "Evaluate keypoint predictions using PCK (bbox-normalized distance) with optional COCO OKS mAP, HTML, and overlays.",
      "tags": ["eval", "keypoints", "pose"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"], "produces": ["metrics_report_json"] },
      "inputs": [
        { "name": "dataset", "kind": "dir", "required": true, "flag": "--dataset" },
        { "name": "predictions", "kind": "file", "required": true, "flag": "--predictions" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/keypoints_eval.json" },
        { "name": "html", "kind": "file", "required": false, "flag": "--html", "default": null },
        { "name": "overlays_dir", "kind": "dir", "required": false, "flag": "--overlays-dir", "default": null },
        { "name": "split", "kind": "string", "required": false, "flag": "--split" },
        { "name": "title", "kind": "string", "required": false, "flag": "--title" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "min_score", "kind": "number", "required": false, "flag": "--min-score" },
        { "name": "per_image_limit", "kind": "number", "required": false, "flag": "--per-image-limit" },
        { "name": "pck_threshold", "kind": "number", "required": false, "flag": "--pck-threshold" },
        { "name": "iou_threshold", "kind": "number", "required": false, "flag": "--iou-threshold" },
        { "name": "oks", "kind": "string", "required": false, "flag": "--oks" },
        { "name": "oks_max_dets", "kind": "number", "required": false, "flag": "--oks-max-dets" },
        { "name": "oks_sigmas", "kind": "string", "required": false, "flag": "--oks-sigmas" },
        { "name": "oks_sigmas_file", "kind": "file", "required": false, "flag": "--oks-sigmas-file" },
        { "name": "kp_line", "kind": "number", "required": false, "flag": "--kp-line" },
        { "name": "kp_radius", "kind": "number", "required": false, "flag": "--kp-radius" },
        { "name": "max_overlays", "kind": "number", "required": false, "flag": "--max-overlays" },
        { "name": "overlay_max_size", "kind": "number", "required": false, "flag": "--overlay-max-size" },
        { "name": "overlay_sort", "kind": "string", "required": false, "flag": "--overlay-sort" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Writes keypoints evaluation JSON report." },
          { "flag": "--html", "kind": "file", "scope": "path", "description": "Optional HTML report output." },
          { "flag": "--overlays-dir", "kind": "dir", "scope": "tree", "description": "Optional overlay image outputs." }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "keypoints_eval_json", "kind": "file", "default": "reports/keypoints_eval.json" }],
      "examples": [
        {
          "description": "Evaluate keypoint predictions and write a JSON report.",
          "command": "python3 tools/eval_keypoints.py --dataset data/coco128 --predictions reports/predictions.json --output reports/keypoints_eval.json"
        },
        {
          "description": "Evaluate keypoints with COCO OKS mAP (requires pycocotools).",
          "command": "python3 tools/eval_keypoints.py --dataset data/coco128 --predictions reports/predictions.json --oks --output reports/keypoints_eval_oks.json"
        }
      ]
    },
    {
      "id": "eval_coco",
      "entrypoint": "tools/eval_coco.py",
      "runner": "python3",
      "summary": "Evaluate predictions on a YOLO-format dataset using COCOeval (or dry-run convert/validate).",
      "tags": ["eval", "coco"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"], "produces": ["coco_eval_report_json"] },
      "contract_outputs": { "coco_eval_report_json": "coco_eval_json" },
      "inputs": [
        { "name": "dataset", "kind": "dir", "required": true, "flag": "--dataset" },
        { "name": "predictions", "kind": "file", "required": true, "flag": "--predictions" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/coco_eval.json" },
        { "name": "protocol", "kind": "string", "required": false, "flag": "--protocol" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "bbox_format", "kind": "string", "required": false, "flag": "--bbox-format" },
        { "name": "dry_run", "kind": "string", "required": false, "flag": "--dry-run" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Writes COCO evaluation JSON report." }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "coco_eval_json", "kind": "file", "default": "reports/coco_eval.json" }],
      "examples": [
        {
          "description": "Dry-run conversion/validation without pycocotools.",
          "command": "python3 tools/eval_coco.py --dataset data/coco128 --predictions reports/predictions.json --dry-run --output reports/coco_eval_dry.json"
        }
      ]
    },
    {
      "id": "eval_suite",
      "entrypoint": "tools/eval_suite.py",
      "runner": "python3",
      "summary": "Evaluate a set of bucketed prediction JSONs (glob) and write a single suite report JSON.",
      "tags": ["eval", "suite", "yolo26"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"], "produces": ["eval_suite_report_json"] },
      "contract_outputs": { "eval_suite_report_json": "eval_suite_json" },
      "inputs": [
        { "name": "predictions_glob", "kind": "string", "required": true, "flag": "--predictions-glob" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/eval_suite.json" },
        { "name": "protocol", "kind": "string", "required": false, "flag": "--protocol" },
        { "name": "dataset", "kind": "dir", "required": false, "flag": "--dataset" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "bbox_format", "kind": "string", "required": false, "flag": "--bbox-format" },
        { "name": "strict", "kind": "string", "required": false, "flag": "--strict" },
        { "name": "dry_run", "kind": "string", "required": false, "flag": "--dry-run" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Writes eval suite JSON report." }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "eval_suite_json", "kind": "file", "default": "reports/eval_suite.json" }],
      "examples": [
        {
          "description": "Evaluate all YOLO26 bucket predictions (no COCOeval) on coco128.",
          "command": "python3 tools/eval_suite.py --protocol yolo26 --dataset data/coco128 --predictions-glob 'reports/pred_yolo26*.json' --dry-run --output reports/eval_suite.json"
        }
      ],
      "docs": ["docs/yolo26_eval_protocol.md"]
    },
    {
      "id": "validate_map_targets",
      "entrypoint": "tools/validate_map_targets.py",
      "runner": "python3",
      "summary": "Validate the mAP target table file (baselines/yolo26_targets.json).",
      "tags": ["eval", "targets", "yolo26"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "inputs": [{ "name": "targets", "kind": "file", "required": false, "flag": "--targets", "default": "baselines/yolo26_targets.json" }],
      "effects": { "writes": [], "fixed_writes": [] },
      "outputs": [{ "name": "stdout", "kind": "stdout", "description": "OK or error details." }],
      "examples": [
        { "description": "Validate targets JSON.", "command": "python3 tools/validate_map_targets.py --targets baselines/yolo26_targets.json" }
      ]
    },
    {
      "id": "check_map_targets",
      "entrypoint": "tools/check_map_targets.py",
      "runner": "python3",
      "summary": "Compare eval_suite results against a target table and exit non-zero on failure.",
      "tags": ["eval", "targets", "gates", "yolo26"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "inputs": [
        { "name": "suite", "kind": "file", "required": false, "flag": "--suite", "default": "reports/eval_suite.json" },
        { "name": "targets", "kind": "file", "required": false, "flag": "--targets", "default": "baselines/yolo26_targets.json" },
        { "name": "key", "kind": "string", "required": false, "flag": "--key" },
        { "name": "min_delta", "kind": "number", "required": false, "flag": "--min-delta" }
      ],
      "effects": { "writes": [], "fixed_writes": [] },
      "outputs": [{ "name": "stdout", "kind": "stdout", "description": "JSON report with ok/failures." }],
      "examples": [
        { "description": "Gate a suite run vs targets.", "command": "python3 tools/check_map_targets.py --suite reports/eval_suite.json --targets baselines/yolo26_targets.json --key map50_95" }
      ]
    },
    {
      "id": "calibrate_scores",
      "entrypoint": "tools/calibrate_scores.py",
      "runner": "python3",
      "summary": "Temperature-scale detection scores to improve mAP proxy on a fixed subset (no NMS).",
      "tags": ["predictions", "calibration"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"], "produces": ["predictions_json", "metrics_report_json"] },
      "inputs": [
        { "name": "dataset", "kind": "dir", "required": true, "flag": "--dataset" },
        { "name": "predictions", "kind": "file", "required": true, "flag": "--predictions" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/predictions_calibrated.json" },
        { "name": "output_report", "kind": "file", "required": false, "flag": "--output-report", "default": "reports/calibration_report.json" },
        { "name": "output_artifact", "kind": "file", "required": false, "flag": "--output-artifact", "default": "reports/calibration_artifact.json" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Writes calibrated predictions JSON." },
          { "flag": "--output-report", "kind": "file", "scope": "path", "description": "Writes calibration report JSON." },
          { "flag": "--output-artifact", "kind": "file", "scope": "path", "description": "Writes calibration artifact JSON." }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "predictions_calibrated", "kind": "file", "default": "reports/predictions_calibrated.json" },
        { "name": "report_json", "kind": "file", "default": "reports/calibration_report.json" }
      ],
      "examples": [
        {
          "description": "Calibrate scores on coco128 subset.",
          "command": "python3 tools/calibrate_scores.py --dataset data/coco128 --predictions reports/predictions.json --output reports/predictions_calibrated.json --output-report reports/calibration_report.json"
        }
      ],
      "docs": ["docs/score_calibration.md"]
    },
    {
      "id": "distill_predictions",
      "entrypoint": "tools/distill_predictions.py",
      "runner": "python3",
      "summary": "Offline prediction distillation: blend teacher predictions into a student predictions JSON and write a report (not a training-time anti-forgetting method).",
      "tags": ["predictions", "distillation", "offline"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"], "produces": ["predictions_json", "metrics_report_json"] },
      "inputs": [
        { "name": "student", "kind": "file", "required": true, "flag": "--student" },
        { "name": "teacher", "kind": "file", "required": true, "flag": "--teacher" },
        { "name": "config", "kind": "file", "required": false, "flag": "--config" },
        { "name": "dataset", "kind": "dir", "required": false, "flag": "--dataset" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split" },
        { "name": "alpha", "kind": "number", "required": false, "flag": "--alpha" },
        { "name": "iou_threshold", "kind": "number", "required": false, "flag": "--iou-threshold" },
        { "name": "add_missing", "kind": "string", "required": false, "flag": "--add-missing" },
        { "name": "add_score_scale", "kind": "number", "required": false, "flag": "--add-score-scale" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/predictions_distilled.json" },
        { "name": "output_report", "kind": "file", "required": false, "flag": "--output-report", "default": "reports/distill_report.json" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Writes distilled predictions JSON." },
          { "flag": "--output-report", "kind": "file", "scope": "path", "description": "Writes distillation report JSON." }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "predictions_distilled", "kind": "file", "default": "reports/predictions_distilled.json" },
        { "name": "report_json", "kind": "file", "default": "reports/distill_report.json" }
      ],
      "examples": [
        {
          "description": "Distill scores and evaluate proxy metrics on coco128.",
          "command": "python3 tools/distill_predictions.py --student reports/predictions_student.json --teacher reports/predictions_teacher.json --dataset data/coco128 --output reports/predictions_distilled.json --output-report reports/distill_report.json --add-missing"
        }
      ],
      "docs": ["docs/distillation.md"]
    },
    {
      "id": "hpo_sweep",
      "entrypoint": "tools/hpo_sweep.py",
      "runner": "python3",
      "summary": "Run a configurable parameter sweep (grid or list) and emit JSONL/CSV/MD results.",
      "tags": ["sweep", "hpo"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "inputs": [
        { "name": "config", "kind": "file", "required": true, "flag": "--config" },
        { "name": "dry_run", "kind": "string", "required": false, "flag": "--dry-run" },
        { "name": "max_runs", "kind": "number", "required": false, "flag": "--max-runs" },
        { "name": "resume", "kind": "string", "required": false, "flag": "--resume" }
      ],
      "effects": {
        "writes": [],
        "fixed_writes": [
          { "path": "reports/hpo_sweep.jsonl", "kind": "file", "scope": "path", "description": "Default results JSONL (config can override)." },
          { "path": "reports/hpo_sweep.csv", "kind": "file", "scope": "path", "description": "Default results CSV (config can override)." },
          { "path": "reports/hpo_sweep.md", "kind": "file", "scope": "path", "description": "Default results Markdown table (config can override)." }
        ]
      },
      "outputs": [
        { "name": "result_jsonl", "kind": "file", "default": "reports/hpo_sweep.jsonl" },
        { "name": "result_csv", "kind": "file", "default": "reports/hpo_sweep.csv" },
        { "name": "result_md", "kind": "file", "default": "reports/hpo_sweep.md" }
      ],
      "examples": [
        {
          "description": "Dry-run example sweep.",
          "command": "python3 tools/hpo_sweep.py --config docs/hpo_sweep_example.json --dry-run"
        }
      ],
      "docs": ["docs/hpo_sweep.md"]
    },
    {
      "id": "tune_gate_weights",
      "entrypoint": "tools/tune_gate_weights.py",
      "runner": "python3",
      "summary": "Offline grid-search for inference-time score-fusion weights (CPU-only, simple mAP proxy).",
      "tags": ["predictions", "gates", "tuning"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"], "produces": ["metrics_report_json"] },
      "inputs": [
        { "name": "config", "kind": "file", "required": false, "flag": "--config" },
        { "name": "dataset", "kind": "dir", "required": true, "flag": "--dataset" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "predictions", "kind": "file", "required": true, "flag": "--predictions" },
        { "name": "output_report", "kind": "file", "required": false, "flag": "--output-report", "default": "reports/gate_tuning_report.json" },
        { "name": "output_predictions", "kind": "file", "required": false, "flag": "--output-predictions", "default": null },
        { "name": "metric", "kind": "string", "required": false, "flag": "--metric" },
        { "name": "det_score_key", "kind": "string", "required": false, "flag": "--det-score-key" },
        { "name": "template_score_key", "kind": "string", "required": false, "flag": "--template-score-key" },
        { "name": "sigma_z_key", "kind": "string", "required": false, "flag": "--sigma-z-key" },
        { "name": "sigma_rot_key", "kind": "string", "required": false, "flag": "--sigma-rot-key" },
        { "name": "preserve_det_score_key", "kind": "string", "required": false, "flag": "--preserve-det-score-key" },
        { "name": "grid_det", "kind": "string", "required": false, "flag": "--grid-det" },
        { "name": "grid_tmp", "kind": "string", "required": false, "flag": "--grid-tmp" },
        { "name": "grid_unc", "kind": "string", "required": false, "flag": "--grid-unc" },
        { "name": "grid_tau", "kind": "string", "required": false, "flag": "--grid-tau" },
        { "name": "template_gate", "kind": "string", "required": false, "flag": "--template-gate" },
        { "name": "no_template_gate", "kind": "string", "required": false, "flag": "--no-template-gate" },
        { "name": "tau", "kind": "number", "required": false, "flag": "--tau" },
        { "name": "min_score", "kind": "number", "required": false, "flag": "--min-score" },
        { "name": "topk_per_image", "kind": "number", "required": false, "flag": "--topk-per-image" },
        { "name": "wrap_output", "kind": "string", "required": false, "flag": "--wrap-output" },
        { "name": "no_wrap_output", "kind": "string", "required": false, "flag": "--no-wrap-output" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output-report", "kind": "file", "scope": "path", "description": "Writes gate tuning report JSON." },
          { "flag": "--output-predictions", "kind": "file", "scope": "path", "description": "Optional tuned predictions JSON output." }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "report_json", "kind": "file", "default": "reports/gate_tuning_report.json" }],
      "examples": [
        {
          "description": "Tune weights on a small coco128 slice.",
          "command": "python3 tools/tune_gate_weights.py --dataset data/coco128 --predictions reports/predictions.json --metric map50_95 --grid-det 1.0 --grid-tmp 0.0,0.5,1.0 --grid-unc 0.0,0.5,1.0 --output-report reports/gate_tuning_report.json"
        }
      ],
      "docs": ["docs/gate_weight_tuning.md"]
    },
    {
      "id": "check_predictions_parity",
      "entrypoint": "tools/check_predictions_parity.py",
      "runner": "python3",
      "summary": "Compare two prediction JSONs and report mismatches (IoU/tolerance-based).",
      "tags": ["predictions", "parity"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"] },
      "effects": { "writes": [], "fixed_writes": [] },
      "inputs": [
        { "name": "reference", "kind": "file", "required": true, "flag": "--reference" },
        { "name": "candidate", "kind": "file", "required": true, "flag": "--candidate" },
        { "name": "bbox_format", "kind": "string", "required": false, "flag": "--bbox-format" },
        { "name": "image_size", "kind": "string", "required": false, "flag": "--image-size" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "iou_thresh", "kind": "number", "required": false, "flag": "--iou-thresh" },
        { "name": "score_atol", "kind": "number", "required": false, "flag": "--score-atol" },
        { "name": "bbox_atol", "kind": "number", "required": false, "flag": "--bbox-atol" }
      ],
      "outputs": [{ "name": "stdout", "kind": "stdout", "description": "Mismatch report (JSON/text) and exit status." }],
      "examples": [
        {
          "description": "Parity check without reading image files (fixed image size).",
          "command": "python3 tools/check_predictions_parity.py --reference reports/pred_ref.json --candidate reports/pred_cand.json --image-size 640 --iou-thresh 0.99 --score-atol 1e-4 --bbox-atol 1e-4"
        }
      ],
      "docs": ["docs/onnx_export_parity.md"]
    },
    {
      "id": "check_keypoints_parity",
      "entrypoint": "tools/check_keypoints_parity.py",
      "runner": "python3",
      "summary": "Compare two keypoints prediction JSONs and report mismatches (IoU/tolerance-based).",
      "tags": ["predictions", "parity", "keypoints", "pose"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"] },
      "effects": { "writes": [], "fixed_writes": [] },
      "inputs": [
        { "name": "reference", "kind": "file", "required": true, "flag": "--reference" },
        { "name": "candidate", "kind": "file", "required": true, "flag": "--candidate" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "iou_thresh", "kind": "number", "required": false, "flag": "--iou-thresh" },
        { "name": "score_atol", "kind": "number", "required": false, "flag": "--score-atol" },
        { "name": "bbox_atol", "kind": "number", "required": false, "flag": "--bbox-atol" },
        { "name": "kp_atol", "kind": "number", "required": false, "flag": "--kp-atol" }
      ],
      "outputs": [{ "name": "stdout", "kind": "stdout", "description": "Mismatch report (JSON/text) and exit status." }],
      "examples": [
        {
          "description": "Parity check for keypoints in normalized coords.",
          "command": "python3 tools/check_keypoints_parity.py --reference reports/pred_ref.json --candidate reports/pred_cand.json --iou-thresh 0.99 --kp-atol 1e-4 --score-atol 1e-4 --bbox-atol 1e-4"
        }
      ],
      "docs": ["docs/onnx_export_parity.md"]
    },
    {
      "id": "adapter_parity_suite",
      "entrypoint": "tools/adapter_parity_suite.py",
      "runner": "python3",
      "summary": "Run parity checks for multiple adapter outputs against a reference adapter predictions file.",
      "tags": ["adapter", "parity", "validation"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"] },
      "inputs": [
        { "name": "adapter_predictions", "kind": "string", "required": true, "flag": "--adapter-predictions", "description": "Repeatable adapter=predictions.json mapping." },
        { "name": "reference_adapter", "kind": "string", "required": false, "flag": "--reference-adapter" },
        { "name": "image_size", "kind": "string", "required": false, "flag": "--image-size" },
        { "name": "iou_thresh", "kind": "number", "required": false, "flag": "--iou-thresh" },
        { "name": "score_atol", "kind": "number", "required": false, "flag": "--score-atol" },
        { "name": "bbox_atol", "kind": "number", "required": false, "flag": "--bbox-atol" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/adapter_parity_suite.json" }
      ],
      "effects": {
        "writes": [
          {
            "flag": "--output",
            "kind": "file",
            "scope": "path",
            "description": "Writes adapter parity suite JSON report."
          }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "adapter_parity_suite_json", "kind": "file", "description": "Adapter parity report JSON.", "default": "reports/adapter_parity_suite.json" }],
      "examples": [
        {
          "description": "Compare framework adapter outputs against RT-DETR reference predictions.",
          "command": "python3 tools/adapter_parity_suite.py --adapter-predictions rtdetr=reports/pred_rtdetr.json --adapter-predictions mmdet=reports/pred_mmdet.json --adapter-predictions detectron2=reports/pred_detectron2.json --adapter-predictions ultralytics=reports/pred_ultralytics.json --adapter-predictions opencv_dnn=reports/pred_opencv_dnn.json --adapter-predictions custom_cpp=reports/pred_custom_cpp.json --reference-adapter rtdetr --output reports/adapter_parity_suite.json"
        }
      ],
      "docs": ["docs/adapter_templates.md", "docs/adapter_contract.md"]
    },
    {
      "id": "backend_parity_matrix",
      "entrypoint": "tools/backend_parity_matrix.py",
      "runner": "python3",
      "summary": "Run one-command backend parity matrix checks across torch/onnxrt/trt/opencv_dnn/custom_cpp and export JSON+HTML reports.",
      "tags": ["backend", "parity", "validation", "report"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"] },
      "inputs": [
        { "name": "backend_predictions", "kind": "string", "required": true, "flag": "--backend-predictions", "description": "Repeatable backend=predictions.json mapping (torch/onnxrt/trt/opencv_dnn/custom_cpp)." },
        { "name": "reference_backend", "kind": "string", "required": false, "flag": "--reference-backend", "default": "torch" },
        { "name": "image_size", "kind": "string", "required": false, "flag": "--image-size" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "iou_thresh", "kind": "number", "required": false, "flag": "--iou-thresh", "default": 0.99 },
        { "name": "score_atol", "kind": "number", "required": false, "flag": "--score-atol", "default": 0.0001 },
        { "name": "bbox_atol", "kind": "number", "required": false, "flag": "--bbox-atol", "default": 0.0001 },
        { "name": "run_id", "kind": "string", "required": false, "flag": "--run-id" },
        { "name": "runs_dir", "kind": "dir", "required": false, "flag": "--runs-dir", "default": "runs" },
        { "name": "run_dir", "kind": "dir", "required": false, "flag": "--run-dir" },
        { "name": "output_json", "kind": "file", "required": false, "flag": "--output-json" },
        { "name": "output_html", "kind": "file", "required": false, "flag": "--output-html" }
      ],
      "effects": {
        "writes": [
          {
            "flag": "--output-json",
            "kind": "file",
            "scope": "path",
            "description": "Writes backend parity matrix JSON report (defaults to <run_dir>/reports/backend_parity_matrix.json)."
          },
          {
            "flag": "--output-html",
            "kind": "file",
            "scope": "path",
            "description": "Writes backend parity matrix HTML report (defaults to <run_dir>/reports/backend_parity_matrix.html)."
          },
          {
            "flag": "--run-dir",
            "kind": "dir",
            "scope": "tree",
            "description": "Creates run/report directories under --run-dir when provided."
          }
        ],
        "fixed_writes": [
          {
            "path": "runs/backend_parity_matrix",
            "kind": "dir",
            "scope": "tree",
            "description": "Default run root when --run-dir is not provided."
          }
        ]
      },
      "outputs": [
        { "name": "report_json", "kind": "file", "default": "runs/backend_parity_matrix/<run_id>/reports/backend_parity_matrix.json" },
        { "name": "report_html", "kind": "file", "default": "runs/backend_parity_matrix/<run_id>/reports/backend_parity_matrix.html" }
      ],
      "examples": [
        {
          "description": "One-command parity matrix against torch reference with fixed thresholds.",
          "command": "python3 tools/backend_parity_matrix.py --backend-predictions torch=reports/pred_torch.json --backend-predictions onnxrt=reports/pred_onnxrt.json --backend-predictions trt=reports/pred_trt.json --backend-predictions opencv_dnn=reports/pred_opencv_dnn.json --backend-predictions custom_cpp=reports/pred_custom_cpp.json --reference-backend torch --image-size 640 --iou-thresh 0.99 --score-atol 1e-4 --bbox-atol 1e-4"
        }
      ],
      "docs": ["docs/backend_parity_matrix.md", "docs/onnx_export_parity.md"]
    },
    {
      "id": "check_golden_compatibility",
      "entrypoint": "tools/check_golden_compatibility.py",
      "runner": "python3",
      "summary": "Validate versioned golden compatibility assets and hash-pinned eval protocol snapshots.",
      "tags": ["golden", "compatibility", "schema", "protocol", "gate"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": {
        "consumes": [
          "predictions_json",
          "segmentation_predictions_json",
          "instance_segmentation_predictions_json"
        ]
      },
      "inputs": [
        { "name": "manifest", "kind": "file", "required": false, "flag": "--manifest", "default": "baselines/golden/v1/manifest.json" }
      ],
      "effects": { "writes": [], "fixed_writes": [] },
      "outputs": [
        {
          "name": "stdout",
          "kind": "stdout",
          "description": "Validation summary JSON; non-zero exit on incompatibility/hash mismatch."
        }
      ],
      "examples": [
        {
          "description": "Run golden compatibility gate using versioned baseline manifest.",
          "command": "python3 tools/check_golden_compatibility.py --manifest baselines/golden/v1/manifest.json"
        }
      ],
      "docs": ["docs/rfc_workflow.md", "docs/schema_governance.md"]
    },
    {
      "id": "refine_predictions_hessian",
      "entrypoint": "tools/refine_predictions_hessian.py",
      "runner": "python3",
      "summary": "Refine pose-related prediction fields with a safe Newton/finite-diff Hessian stepper (experimental).",
      "tags": ["predictions", "refine", "hessian", "pose"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "requires": { "python_packages": ["torch"] },
      "contracts": { "consumes": ["predictions_json"], "produces": ["predictions_json"] },
      "inputs": [
        { "name": "predictions", "kind": "file", "required": true, "flag": "--predictions" },
        { "name": "output", "kind": "file", "required": true, "flag": "--output" },
        { "name": "wrap", "kind": "string", "required": false, "flag": "--wrap" },
        { "name": "refine_offsets", "kind": "string", "required": false, "flag": "--refine-offsets" },
        { "name": "dataset", "kind": "dir", "required": false, "flag": "--dataset" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split" },
        { "name": "device", "kind": "string", "required": false, "flag": "--device" },
        { "name": "steps", "kind": "number", "required": false, "flag": "--steps" },
        { "name": "damping", "kind": "number", "required": false, "flag": "--damping" },
        { "name": "fd_eps", "kind": "number", "required": false, "flag": "--fd-eps" },
        { "name": "line_search", "kind": "number", "required": false, "flag": "--line-search" },
        { "name": "line_search_decay", "kind": "number", "required": false, "flag": "--line-search-decay" },
        { "name": "w_reg", "kind": "number", "required": false, "flag": "--w-reg" },
        { "name": "w_depth", "kind": "number", "required": false, "flag": "--w-depth" },
        { "name": "w_mask", "kind": "number", "required": false, "flag": "--w-mask" },
        { "name": "max_step_px", "kind": "number", "required": false, "flag": "--max-step-px" },
        { "name": "max_total_update_px", "kind": "number", "required": false, "flag": "--max-total-update-px" },
        { "name": "tol_delta", "kind": "number", "required": false, "flag": "--tol-delta" },
        { "name": "tol_loss", "kind": "number", "required": false, "flag": "--tol-loss" },
        { "name": "log_output", "kind": "file", "required": false, "flag": "--log-output" },
        { "name": "log_steps", "kind": "string", "required": false, "flag": "--log-steps" },
        { "name": "dry_run", "kind": "string", "required": false, "flag": "--dry-run" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Writes refined predictions JSON." }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "predictions_json", "kind": "file", "description": "Refined predictions JSON written to --output." }],
      "examples": [
        {
          "description": "Refine offsets in-place (CPU default).",
          "command": "python3 tools/refine_predictions_hessian.py --predictions reports/predictions.json --refine-offsets --steps 5 --output reports/predictions_refined.json --wrap"
        }
      ]
    },
    {
      "id": "export_predictions_onnxrt",
      "entrypoint": "tools/export_predictions_onnxrt.py",
      "runner": "python3",
      "summary": "Run ONNXRuntime inference and export YOLOZU predictions JSON (requires onnxruntime + numpy + opencv).",
      "tags": ["predictions", "onnxruntime"],
      "platform": {
        "cpu_ok": true,
        "gpu_required": false,
        "macos_ok": true,
        "linux_ok": true,
        "notes": "ONNXRuntime execution provider depends on your environment."
      },
      "requires": { "python_packages": ["onnxruntime", "numpy", "opencv-python"] },
      "contracts": { "produces": ["predictions_json"] },
      "inputs": [
        { "name": "onnx", "kind": "file", "required": false, "flag": "--onnx", "default": null },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/predictions_onnxrt.json" },
        { "name": "dataset", "kind": "dir", "required": false, "flag": "--dataset" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "input_name", "kind": "string", "required": false, "flag": "--input-name" },
        { "name": "combined_output", "kind": "string", "required": false, "flag": "--combined-output" },
        { "name": "combined_format", "kind": "string", "required": false, "flag": "--combined-format" },
        { "name": "boxes_output", "kind": "file", "required": false, "flag": "--boxes-output" },
        { "name": "boxes_format", "kind": "string", "required": false, "flag": "--boxes-format" },
        { "name": "boxes_scale", "kind": "string", "required": false, "flag": "--boxes-scale" },
        { "name": "class_output", "kind": "file", "required": false, "flag": "--class-output" },
        { "name": "scores_output", "kind": "file", "required": false, "flag": "--scores-output" },
        { "name": "raw_output", "kind": "file", "required": false, "flag": "--raw-output" },
        { "name": "raw_format", "kind": "string", "required": false, "flag": "--raw-format" },
        { "name": "raw_postprocess", "kind": "string", "required": false, "flag": "--raw-postprocess" },
        { "name": "nms_iou", "kind": "number", "required": false, "flag": "--nms-iou" },
        { "name": "agnostic_nms", "kind": "string", "required": false, "flag": "--agnostic-nms" },
        { "name": "topk", "kind": "number", "required": false, "flag": "--topk" },
        { "name": "min_score", "kind": "number", "required": false, "flag": "--min-score" },
        { "name": "wrap", "kind": "string", "required": false, "flag": "--wrap" },
        { "name": "strict", "kind": "string", "required": false, "flag": "--strict" },
        { "name": "dry_run", "kind": "string", "required": false, "flag": "--dry-run" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Writes predictions JSON." },
          { "flag": "--boxes-output", "kind": "file", "scope": "path", "description": "Optional raw boxes output." },
          { "flag": "--class-output", "kind": "file", "scope": "path", "description": "Optional raw class output." },
          { "flag": "--scores-output", "kind": "file", "scope": "path", "description": "Optional raw scores output." },
          { "flag": "--raw-output", "kind": "file", "scope": "path", "description": "Optional raw tensor output." }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "predictions_json", "kind": "file", "default": "reports/predictions_onnxrt.json" },
        { "name": "boxes_output", "kind": "file", "description": "Optional raw boxes output when --boxes-output is set." },
        { "name": "class_output", "kind": "file", "description": "Optional raw class output when --class-output is set." },
        { "name": "scores_output", "kind": "file", "description": "Optional raw scores output when --scores-output is set." },
        { "name": "raw_output", "kind": "file", "description": "Optional raw tensor output when --raw-output is set." }
      ],
      "examples": [
        {
          "description": "Export ONNXRuntime predictions (dry-run mode exists).",
          "command": "python3 tools/export_predictions_onnxrt.py --dataset data/coco128 --onnx /abs/path/model.onnx --combined-output output0 --combined-format xyxy_score_class --boxes-scale abs --min-score 0.0 --wrap --output reports/pred_onnxrt.json"
        }
      ],
      "docs": ["docs/onnx_export_parity.md"]
    },
    {
      "id": "build_trt_engine",
      "entrypoint": "tools/build_trt_engine.py",
      "runner": "python3",
      "summary": "Build a TensorRT engine from ONNX using trtexec and write a reproducible meta JSON.",
      "tags": ["tensorrt", "engine"],
      "platform": {
        "cpu_ok": true,
        "gpu_required": true,
        "macos_ok": false,
        "linux_ok": true,
        "notes": "Typically requires Linux + NVIDIA + TensorRT (trtexec)."
      },
      "requires": { "system": ["trtexec"] },
      "inputs": [
        { "name": "onnx", "kind": "file", "required": true, "flag": "--onnx" },
        { "name": "engine", "kind": "file", "required": false, "flag": "--engine", "default": "engines/model.plan" },
        { "name": "timing_cache", "kind": "file", "required": false, "flag": "--timing-cache", "default": "engines/timing.cache" },
        { "name": "meta_output", "kind": "file", "required": false, "flag": "--meta-output", "default": "reports/trt_engine_meta.json" },
        { "name": "precision", "kind": "string", "required": false, "flag": "--precision" },
        { "name": "input_name", "kind": "string", "required": false, "flag": "--input-name" },
        { "name": "min_shape", "kind": "string", "required": false, "flag": "--min-shape" },
        { "name": "opt_shape", "kind": "string", "required": false, "flag": "--opt-shape" },
        { "name": "max_shape", "kind": "string", "required": false, "flag": "--max-shape" },
        { "name": "workspace", "kind": "number", "required": false, "flag": "--workspace" },
        { "name": "trtexec", "kind": "string", "required": false, "flag": "--trtexec" },
        { "name": "builder", "kind": "string", "required": false, "flag": "--builder" },
        { "name": "calib_cache", "kind": "file", "required": false, "flag": "--calib-cache" },
        { "name": "calib_dataset", "kind": "dir", "required": false, "flag": "--calib-dataset" },
        { "name": "calib_split", "kind": "string", "required": false, "flag": "--calib-split" },
        { "name": "calib_images", "kind": "number", "required": false, "flag": "--calib-images" },
        { "name": "calib_list_output", "kind": "file", "required": false, "flag": "--calib-list-output" },
        { "name": "extra_args", "kind": "string", "required": false, "flag": "--extra-args" },
        { "name": "dry_run", "kind": "string", "required": false, "flag": "--dry-run" }
      ],
      "effects": {
        "writes": [
          { "flag": "--engine", "kind": "file", "scope": "path", "description": "Writes TensorRT engine plan." },
          { "flag": "--timing-cache", "kind": "file", "scope": "path", "description": "Writes timing cache." },
          { "flag": "--meta-output", "kind": "file", "scope": "path", "description": "Writes build metadata JSON." },
          { "flag": "--calib-cache", "kind": "file", "scope": "path", "description": "Optional INT8 calibration cache output." },
          { "flag": "--calib-list-output", "kind": "file", "scope": "path", "description": "Optional calibration image list output." }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "engine_plan", "kind": "file", "default": "engines/model.plan" },
        { "name": "timing_cache", "kind": "file", "default": "engines/timing.cache" },
        { "name": "meta_output", "kind": "file", "default": "reports/trt_engine_meta.json" }
      ],
      "examples": [
        {
          "description": "Build FP16 engine (Linux/NVIDIA).",
          "command": "python3 tools/build_trt_engine.py --onnx yolo26n.onnx --engine engines/yolo26n_fp16.plan --precision fp16 --input-name images --min-shape 1x3x640x640 --opt-shape 1x3x640x640 --max-shape 1x3x640x640 --timing-cache engines/timing.cache --meta-output reports/trt_engine_yolo26n_fp16.json"
        }
      ],
      "docs": ["docs/tensorrt_pipeline.md"]
    },
    {
      "id": "export_trt",
      "entrypoint": "tools/export_trt.py",
      "runner": "python3",
      "summary": "Canonical PyTorch → ONNX → TensorRT export route for in-repo rtdetr_pose models.",
      "tags": ["export", "onnx", "tensorrt", "rtdetr_pose"],
      "platform": {
        "cpu_ok": true,
        "gpu_required": false,
        "macos_ok": true,
        "linux_ok": true,
        "notes": "ONNX export can run on CPU; engine build requires Linux+NVIDIA+trtexec unless --skip-engine is set."
      },
      "requires": { "python_packages": ["torch", "onnx"], "system": ["trtexec (optional, for engine build)"] },
      "inputs": [
        { "name": "config", "kind": "file", "required": false, "flag": "--config", "default": "rtdetr_pose/configs/base.json" },
        { "name": "checkpoint", "kind": "file", "required": false, "flag": "--checkpoint" },
        { "name": "device", "kind": "string", "required": false, "flag": "--device" },
        { "name": "image_size", "kind": "number", "required": false, "flag": "--image-size" },
        { "name": "onnx", "kind": "file", "required": false, "flag": "--onnx", "default": "models/model.onnx" },
        { "name": "onnx_meta", "kind": "file", "required": false, "flag": "--onnx-meta" },
        { "name": "opset", "kind": "number", "required": false, "flag": "--opset" },
        { "name": "input_name", "kind": "string", "required": false, "flag": "--input-name" },
        { "name": "dynamic_hw", "kind": "string", "required": false, "flag": "--dynamic-hw" },
        { "name": "engine", "kind": "file", "required": false, "flag": "--engine", "default": "engines/model_fp16.plan" },
        { "name": "engine_meta", "kind": "file", "required": false, "flag": "--engine-meta" },
        { "name": "precision", "kind": "string", "required": false, "flag": "--precision" },
        { "name": "min_shape", "kind": "string", "required": false, "flag": "--min-shape" },
        { "name": "opt_shape", "kind": "string", "required": false, "flag": "--opt-shape" },
        { "name": "max_shape", "kind": "string", "required": false, "flag": "--max-shape" },
        { "name": "workspace", "kind": "number", "required": false, "flag": "--workspace" },
        { "name": "timing_cache", "kind": "file", "required": false, "flag": "--timing-cache", "default": "engines/timing.cache" },
        { "name": "trtexec", "kind": "string", "required": false, "flag": "--trtexec" },
        { "name": "extra_args", "kind": "string", "required": false, "flag": "--extra-args" },
        { "name": "skip_onnx", "kind": "string", "required": false, "flag": "--skip-onnx" },
        { "name": "skip_engine", "kind": "string", "required": false, "flag": "--skip-engine" },
        { "name": "dry_run", "kind": "string", "required": false, "flag": "--dry-run" }
      ],
      "effects": {
        "writes": [
          { "flag": "--onnx", "kind": "file", "scope": "path", "description": "Writes ONNX model." },
          { "flag": "--onnx-meta", "kind": "file", "scope": "path", "description": "Optional ONNX export metadata JSON output." },
          { "flag": "--engine", "kind": "file", "scope": "path", "description": "Writes TensorRT engine plan." },
          { "flag": "--engine-meta", "kind": "file", "scope": "path", "description": "Optional engine build metadata JSON output." },
          { "flag": "--timing-cache", "kind": "file", "scope": "path", "description": "Writes timing cache." }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "onnx_model", "kind": "file", "default": "models/model.onnx" },
        { "name": "engine_plan", "kind": "file", "default": "engines/model_fp16.plan" },
        { "name": "timing_cache", "kind": "file", "default": "engines/timing.cache" }
      ],
      "examples": [
        {
          "description": "Export ONNX and build a FP16 engine (Linux/NVIDIA).",
          "command": "python3 tools/export_trt.py --config rtdetr_pose/configs/base.json --checkpoint /path/to/checkpoint.pt --image-size 320 --onnx models/rtdetr_pose.onnx --dynamic-hw --engine engines/rtdetr_pose_fp16.plan --precision fp16 --min-shape 1x3x320x320 --opt-shape 1x3x640x640 --max-shape 1x3x960x960"
        }
      ],
      "docs": ["docs/tensorrt_pipeline.md"]
    },
    {
      "id": "rtdetr_pose_backend_suite",
      "entrypoint": "tools/rtdetr_pose_backend_suite.py",
      "runner": "python3",
      "summary": "Backend parity + benchmark suite for rtdetr_pose (torch vs onnxruntime vs tensorrt).",
      "tags": ["rtdetr_pose", "parity", "benchmark"],
      "platform": {
        "cpu_ok": true,
        "gpu_required": false,
        "macos_ok": true,
        "linux_ok": true,
        "notes": "torch/onnxrt can run on CPU; TensorRT requires Linux+NVIDIA+tensorrt and a built engine plan."
      },
      "requires": { "python_packages": ["torch", "numpy"] },
      "inputs": [
        { "name": "config", "kind": "file", "required": true, "flag": "--config" },
        { "name": "checkpoint", "kind": "file", "required": false, "flag": "--checkpoint" },
        { "name": "device", "kind": "string", "required": false, "flag": "--device" },
        { "name": "image_size", "kind": "number", "required": false, "flag": "--image-size" },
        { "name": "batch", "kind": "number", "required": false, "flag": "--batch" },
        { "name": "samples", "kind": "number", "required": false, "flag": "--samples" },
        { "name": "seed", "kind": "number", "required": false, "flag": "--seed" },
        { "name": "onnx", "kind": "file", "required": false, "flag": "--onnx" },
        { "name": "engine", "kind": "file", "required": false, "flag": "--engine" },
        { "name": "input_name", "kind": "string", "required": false, "flag": "--input-name" },
        { "name": "onnx_meta", "kind": "file", "required": false, "flag": "--onnx-meta" },
        { "name": "engine_meta", "kind": "file", "required": false, "flag": "--engine-meta" },
        { "name": "embed_meta", "kind": "string", "required": false, "flag": "--embed-meta" },
        { "name": "trtexec", "kind": "string", "required": false, "flag": "--trtexec" },
        { "name": "backends", "kind": "string", "required": false, "flag": "--backends" },
        { "name": "reference", "kind": "string", "required": false, "flag": "--reference" },
        { "name": "score_atol", "kind": "number", "required": false, "flag": "--score-atol" },
        { "name": "bbox_atol", "kind": "number", "required": false, "flag": "--bbox-atol" },
        { "name": "warmup", "kind": "number", "required": false, "flag": "--warmup" },
        { "name": "iterations", "kind": "number", "required": false, "flag": "--iterations" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/rtdetr_pose_backend_suite.json" },
        { "name": "dry_run", "kind": "string", "required": false, "flag": "--dry-run" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Writes backend suite JSON report." }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "report_json", "kind": "file", "default": "reports/rtdetr_pose_backend_suite.json" }],
      "examples": [
        {
          "description": "Torch ↔ ONNXRuntime parity + benchmark (CPU).",
          "command": "python3 tools/rtdetr_pose_backend_suite.py --config rtdetr_pose/configs/base.json --checkpoint /path/to/checkpoint.pt --onnx models/rtdetr_pose.onnx --backends torch,onnxrt --device cpu --image-size 320 --samples 2 --warmup 20 --iterations 200 --output reports/rtdetr_pose_backend_suite.json"
        }
      ],
      "docs": ["docs/real_model_interface.md", "docs/tensorrt_pipeline.md"]
    },
    {
      "id": "run_rtdetr_pose_backend_suite",
      "entrypoint": "tools/run_rtdetr_pose_backend_suite.py",
      "runner": "python3",
      "summary": "End-to-end runner for rtdetr_pose: export (PyTorch→ONNX→TRT) + backend parity/benchmark suite.",
      "tags": ["rtdetr_pose", "tensorrt", "parity", "benchmark", "runpod"],
      "platform": {
        "cpu_ok": true,
        "gpu_required": false,
        "macos_ok": true,
        "linux_ok": true,
        "notes": "Dry-run works anywhere; full export+TRT engine build requires Linux+NVIDIA+tensorrt and trtexec."
      },
      "requires": { "python_packages": ["torch", "numpy"] },
      "inputs": [
        { "name": "config", "kind": "file", "required": false, "flag": "--config", "default": "rtdetr_pose/configs/base.json" },
        { "name": "checkpoint", "kind": "file", "required": false, "flag": "--checkpoint" },
        { "name": "device", "kind": "string", "required": false, "flag": "--device" },
        { "name": "export_device", "kind": "string", "required": false, "flag": "--export-device" },
        { "name": "precision", "kind": "string", "required": false, "flag": "--precision" },
        { "name": "input_name", "kind": "string", "required": false, "flag": "--input-name" },
        { "name": "opset", "kind": "number", "required": false, "flag": "--opset" },
        { "name": "dynamic_hw", "kind": "string", "required": false, "flag": "--dynamic-hw" },
        { "name": "no_dynamic_hw", "kind": "string", "required": false, "flag": "--no-dynamic-hw" },
        { "name": "export_image_size", "kind": "number", "required": false, "flag": "--export-image-size" },
        { "name": "suite_image_size", "kind": "number", "required": false, "flag": "--suite-image-size" },
        { "name": "max_image_size", "kind": "number", "required": false, "flag": "--max-image-size" },
        { "name": "min_shape", "kind": "string", "required": false, "flag": "--min-shape" },
        { "name": "opt_shape", "kind": "string", "required": false, "flag": "--opt-shape" },
        { "name": "max_shape", "kind": "string", "required": false, "flag": "--max-shape" },
        { "name": "workspace", "kind": "number", "required": false, "flag": "--workspace" },
        { "name": "trtexec", "kind": "string", "required": false, "flag": "--trtexec" },
        { "name": "extra_args", "kind": "string", "required": false, "flag": "--extra-args" },
        { "name": "batch", "kind": "number", "required": false, "flag": "--batch" },
        { "name": "samples", "kind": "number", "required": false, "flag": "--samples" },
        { "name": "seed", "kind": "number", "required": false, "flag": "--seed" },
        { "name": "score_atol", "kind": "number", "required": false, "flag": "--score-atol" },
        { "name": "bbox_atol", "kind": "number", "required": false, "flag": "--bbox-atol" },
        { "name": "warmup", "kind": "number", "required": false, "flag": "--warmup" },
        { "name": "iterations", "kind": "number", "required": false, "flag": "--iterations" },
        { "name": "backends", "kind": "string", "required": false, "flag": "--backends" },
        { "name": "embed_meta", "kind": "string", "required": false, "flag": "--embed-meta" },
        { "name": "run_id", "kind": "string", "required": false, "flag": "--run-id" },
        { "name": "run_dir", "kind": "dir", "required": false, "flag": "--run-dir" },
        { "name": "onnx", "kind": "file", "required": false, "flag": "--onnx", "default": null },
        { "name": "engine", "kind": "file", "required": false, "flag": "--engine", "default": null },
        { "name": "timing_cache", "kind": "file", "required": false, "flag": "--timing-cache", "default": null },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": null },
        { "name": "skip_onnx", "kind": "string", "required": false, "flag": "--skip-onnx" },
        { "name": "skip_engine", "kind": "string", "required": false, "flag": "--skip-engine" },
        { "name": "force", "kind": "string", "required": false, "flag": "--force" },
        { "name": "dry_run", "kind": "string", "required": false, "flag": "--dry-run" }
      ],
      "effects": {
        "writes": [
          { "flag": "--run-dir", "kind": "dir", "scope": "tree", "description": "Writes run artifacts under --run-dir." },
          { "flag": "--onnx", "kind": "file", "scope": "path", "description": "Optional ONNX output path." },
          { "flag": "--engine", "kind": "file", "scope": "path", "description": "Optional TensorRT engine output path." },
          { "flag": "--timing-cache", "kind": "file", "scope": "path", "description": "Optional timing cache path." },
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Optional suite report output path." }
        ],
        "fixed_writes": [
          { "path": "runs/rtdetr_pose_backend_suite", "kind": "dir", "scope": "tree", "description": "Default run root when --run-dir is not provided." }
        ]
      },
      "outputs": [{ "name": "suite_report", "kind": "file", "default": "runs/rtdetr_pose_backend_suite/<timestamp>/backend_suite.json" }],
      "examples": [
        {
          "description": "Run export_trt + backend suite (GPU).",
          "command": "python3 tools/run_rtdetr_pose_backend_suite.py --config rtdetr_pose/configs/base.json --checkpoint /path/to/checkpoint.pt --device cuda --precision fp16 --dynamic-hw --export-image-size 320 --suite-image-size 640"
        }
      ],
      "docs": ["docs/tensorrt_pipeline.md"]
    },
    {
      "id": "export_predictions_trt",
      "entrypoint": "tools/export_predictions_trt.py",
      "runner": "python3",
      "summary": "Run TensorRT engine inference and export YOLOZU predictions JSON (requires tensorrt + CUDA bindings).",
      "tags": ["predictions", "tensorrt"],
      "platform": { "cpu_ok": false, "gpu_required": true, "macos_ok": false, "linux_ok": true },
      "requires": { "python_packages": ["tensorrt", "numpy", "opencv-python"], "system": ["CUDA bindings (pycuda or cuda-python)"] },
      "contracts": { "produces": ["predictions_json"] },
      "inputs": [
        { "name": "engine", "kind": "file", "required": false, "flag": "--engine", "default": null },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/predictions_trt.json" },
        { "name": "dataset", "kind": "dir", "required": false, "flag": "--dataset" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "input_name", "kind": "string", "required": false, "flag": "--input-name" },
        { "name": "combined_output", "kind": "string", "required": false, "flag": "--combined-output" },
        { "name": "combined_format", "kind": "string", "required": false, "flag": "--combined-format" },
        { "name": "boxes_output", "kind": "file", "required": false, "flag": "--boxes-output" },
        { "name": "boxes_format", "kind": "string", "required": false, "flag": "--boxes-format" },
        { "name": "boxes_scale", "kind": "string", "required": false, "flag": "--boxes-scale" },
        { "name": "class_output", "kind": "file", "required": false, "flag": "--class-output" },
        { "name": "scores_output", "kind": "file", "required": false, "flag": "--scores-output" },
        { "name": "raw_output", "kind": "file", "required": false, "flag": "--raw-output" },
        { "name": "raw_format", "kind": "string", "required": false, "flag": "--raw-format" },
        { "name": "raw_postprocess", "kind": "string", "required": false, "flag": "--raw-postprocess" },
        { "name": "nms_iou", "kind": "number", "required": false, "flag": "--nms-iou" },
        { "name": "agnostic_nms", "kind": "string", "required": false, "flag": "--agnostic-nms" },
        { "name": "topk", "kind": "number", "required": false, "flag": "--topk" },
        { "name": "min_score", "kind": "number", "required": false, "flag": "--min-score" },
        { "name": "wrap", "kind": "string", "required": false, "flag": "--wrap" },
        { "name": "strict", "kind": "string", "required": false, "flag": "--strict" },
        { "name": "dry_run", "kind": "string", "required": false, "flag": "--dry-run" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Writes predictions JSON." },
          { "flag": "--boxes-output", "kind": "file", "scope": "path", "description": "Optional raw boxes output." },
          { "flag": "--class-output", "kind": "file", "scope": "path", "description": "Optional raw class output." },
          { "flag": "--scores-output", "kind": "file", "scope": "path", "description": "Optional raw scores output." },
          { "flag": "--raw-output", "kind": "file", "scope": "path", "description": "Optional raw tensor output." }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "predictions_json", "kind": "file", "default": "reports/predictions_trt.json" },
        { "name": "boxes_output", "kind": "file", "description": "Optional raw boxes output when --boxes-output is set." },
        { "name": "class_output", "kind": "file", "description": "Optional raw class output when --class-output is set." },
        { "name": "scores_output", "kind": "file", "description": "Optional raw scores output when --scores-output is set." },
        { "name": "raw_output", "kind": "file", "description": "Optional raw tensor output when --raw-output is set." }
      ],
      "examples": [
        {
          "description": "Export TensorRT predictions (engine must exist).",
          "command": "python3 tools/export_predictions_trt.py --dataset /path/to/coco-yolo --engine engines/yolo26n_fp16.plan --combined-output output0 --boxes-scale abs --wrap --output reports/pred_trt_yolo26n.json"
        }
      ],
      "docs": ["docs/tensorrt_pipeline.md"]
    },
    {
      "id": "measure_trt_latency",
      "entrypoint": "tools/measure_trt_latency.py",
      "runner": "python3",
      "summary": "Measure a TensorRT engine's latency/FPS and write a metrics report JSON.",
      "tags": ["benchmark", "tensorrt"],
      "platform": { "cpu_ok": true, "gpu_required": true, "macos_ok": false, "linux_ok": true },
      "requires": { "python_packages": ["tensorrt", "numpy"], "system": ["CUDA bindings (pycuda or cuda-python)"] },
      "contracts": { "produces": ["metrics_report_json"] },
      "inputs": [
        { "name": "engine", "kind": "file", "required": false, "flag": "--engine" },
        { "name": "shape", "kind": "string", "required": false, "flag": "--shape" },
        { "name": "input_name", "kind": "string", "required": false, "flag": "--input-name" },
        { "name": "iterations", "kind": "number", "required": false, "flag": "--iterations", "default": 200 },
        { "name": "warmup", "kind": "number", "required": false, "flag": "--warmup", "default": 20 },
        { "name": "dry_run", "kind": "string", "required": false, "flag": "--dry-run" },
        { "name": "notes", "kind": "string", "required": false, "flag": "--notes" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/latency_trt.json" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Writes metrics report JSON." }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "report_json", "kind": "file", "default": "reports/latency_trt.json" }],
      "examples": [
        {
          "description": "Measure latency (Linux/NVIDIA).",
          "command": "python3 tools/measure_trt_latency.py --engine engines/yolo26n_fp16.plan --shape 1x3x640x640 --iterations 200 --warmup 20 --output reports/latency_yolo26n.json"
        }
      ],
      "docs": ["docs/benchmark_latency.md", "docs/tensorrt_pipeline.md"]
    },
    {
      "id": "run_trt_pipeline",
      "entrypoint": "tools/run_trt_pipeline.py",
      "runner": "python3",
      "summary": "Orchestrate the YOLO26 TensorRT pipeline (engine build → predictions export → parity → eval_suite → latency report).",
      "tags": ["deploy", "pipeline", "tensorrt", "yolo26"],
      "platform": {
        "cpu_ok": true,
        "gpu_required": true,
        "macos_ok": false,
        "linux_ok": true,
        "notes": "Designed for Linux+NVIDIA (Runpod). Use --dry-run to generate schema-correct artifacts without GPU."
      },
      "contracts": { "produces": ["predictions_json", "eval_suite_report_json", "metrics_report_json"] },
      "inputs": [
        { "name": "dataset", "kind": "dir", "required": true, "flag": "--dataset" },
        { "name": "onnx_template", "kind": "string", "required": true, "flag": "--onnx-template" },
        { "name": "run_dir", "kind": "dir", "required": false, "flag": "--run-dir", "default": null },
        { "name": "benchmark_config", "kind": "file", "required": false, "flag": "--benchmark-config" },
        { "name": "benchmark_history", "kind": "file", "required": false, "flag": "--benchmark-history" },
        { "name": "benchmark_output", "kind": "file", "required": false, "flag": "--benchmark-output" },
        { "name": "boxes_scale", "kind": "string", "required": false, "flag": "--boxes-scale" },
        { "name": "buckets", "kind": "string", "required": false, "flag": "--buckets" },
        { "name": "calib_cache_template", "kind": "string", "required": false, "flag": "--calib-cache-template" },
        { "name": "calib_dataset", "kind": "dir", "required": false, "flag": "--calib-dataset" },
        { "name": "calib_images", "kind": "number", "required": false, "flag": "--calib-images" },
        { "name": "calib_list_template", "kind": "string", "required": false, "flag": "--calib-list-template" },
        { "name": "calib_split", "kind": "string", "required": false, "flag": "--calib-split" },
        { "name": "combined_output", "kind": "string", "required": false, "flag": "--combined-output" },
        { "name": "dry_run", "kind": "string", "required": false, "flag": "--dry-run" },
        { "name": "engine_meta_template", "kind": "string", "required": false, "flag": "--engine-meta-template" },
        { "name": "engine_template", "kind": "string", "required": false, "flag": "--engine-template" },
        { "name": "eval_suite_output", "kind": "file", "required": false, "flag": "--eval-suite-output" },
        { "name": "force", "kind": "string", "required": false, "flag": "--force" },
        { "name": "help", "kind": "string", "required": false, "flag": "--help" },
        { "name": "image_size", "kind": "string", "required": false, "flag": "--image-size" },
        { "name": "input_name", "kind": "string", "required": false, "flag": "--input-name" },
        { "name": "latency_iterations", "kind": "number", "required": false, "flag": "--latency-iterations" },
        { "name": "latency_template", "kind": "string", "required": false, "flag": "--latency-template" },
        { "name": "latency_warmup", "kind": "number", "required": false, "flag": "--latency-warmup" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "max_shape", "kind": "string", "required": false, "flag": "--max-shape" },
        { "name": "min_score", "kind": "number", "required": false, "flag": "--min-score" },
        { "name": "min_shape", "kind": "string", "required": false, "flag": "--min-shape" },
        { "name": "notes", "kind": "string", "required": false, "flag": "--notes" },
        { "name": "opt_shape", "kind": "string", "required": false, "flag": "--opt-shape" },
        { "name": "parity_bbox_atol", "kind": "number", "required": false, "flag": "--parity-bbox-atol" },
        { "name": "parity_iou", "kind": "number", "required": false, "flag": "--parity-iou" },
        { "name": "parity_report_template", "kind": "string", "required": false, "flag": "--parity-report-template" },
        { "name": "parity_score_atol", "kind": "number", "required": false, "flag": "--parity-score-atol" },
        { "name": "precision", "kind": "string", "required": false, "flag": "--precision" },
        { "name": "pred_onnxrt_template", "kind": "string", "required": false, "flag": "--pred-onnxrt-template" },
        { "name": "pred_trt_template", "kind": "string", "required": false, "flag": "--pred-trt-template" },
        { "name": "run_id", "kind": "string", "required": false, "flag": "--run-id" },
        { "name": "shape", "kind": "string", "required": false, "flag": "--shape" },
        { "name": "skip_benchmark", "kind": "string", "required": false, "flag": "--skip-benchmark" },
        { "name": "skip_build", "kind": "string", "required": false, "flag": "--skip-build" },
        { "name": "skip_eval", "kind": "string", "required": false, "flag": "--skip-eval" },
        { "name": "skip_latency", "kind": "string", "required": false, "flag": "--skip-latency" },
        { "name": "skip_onnxrt", "kind": "string", "required": false, "flag": "--skip-onnxrt" },
        { "name": "skip_parity", "kind": "string", "required": false, "flag": "--skip-parity" },
        { "name": "skip_trt", "kind": "string", "required": false, "flag": "--skip-trt" },
        { "name": "timing_cache", "kind": "file", "required": false, "flag": "--timing-cache" },
        { "name": "topk", "kind": "number", "required": false, "flag": "--topk" },
        { "name": "trtexec", "kind": "string", "required": false, "flag": "--trtexec" },
        { "name": "workspace_mib", "kind": "number", "required": false, "flag": "--workspace-mib" }
      ],
      "effects": {
        "writes": [
          { "flag": "--run-dir", "kind": "dir", "scope": "tree", "description": "Optional run folder to copy key artifacts into." },
          { "flag": "--engine-template", "kind": "file", "scope": "path", "description": "Writes TensorRT engine outputs rendered from template." },
          { "flag": "--engine-meta-template", "kind": "file", "scope": "path", "description": "Writes per-bucket engine build metadata rendered from template." },
          { "flag": "--timing-cache", "kind": "file", "scope": "path", "description": "Writes TensorRT timing cache." },
          { "flag": "--calib-cache-template", "kind": "file", "scope": "path", "description": "Writes INT8 calibration cache rendered from template (when used)." },
          { "flag": "--calib-list-template", "kind": "file", "scope": "path", "description": "Writes calibration image list rendered from template (when used)." },
          { "flag": "--pred-onnxrt-template", "kind": "file", "scope": "path", "description": "Writes ONNXRuntime predictions JSON rendered from template." },
          { "flag": "--pred-trt-template", "kind": "file", "scope": "path", "description": "Writes TensorRT predictions JSON rendered from template." },
          { "flag": "--parity-report-template", "kind": "file", "scope": "path", "description": "Writes parity report JSON rendered from template." },
          { "flag": "--latency-template", "kind": "file", "scope": "path", "description": "Writes per-bucket latency report JSON rendered from template." },
          { "flag": "--benchmark-config", "kind": "file", "scope": "path", "description": "Writes generated benchmark harness config JSON." },
          { "flag": "--benchmark-output", "kind": "file", "scope": "path", "description": "Writes benchmark latency report JSON." },
          { "flag": "--benchmark-history", "kind": "file", "scope": "path", "description": "Optional JSONL history file for benchmark latency reports." },
          { "flag": "--eval-suite-output", "kind": "file", "scope": "path", "description": "Writes eval suite output JSON." }
        ],
        "fixed_writes": [
          { "path": "engines", "kind": "dir", "scope": "tree", "description": "Default engine outputs and timing cache." },
          { "path": "reports", "kind": "dir", "scope": "tree", "description": "Default reports/artifacts (predictions, parity, eval suite, latency, generated configs)." }
        ]
      },
      "outputs": [{ "name": "run_dir", "kind": "dir", "description": "Run folder containing run.json and copied artifacts." }],
      "examples": [
        {
          "description": "Run full TRT pipeline (Runpod/Linux).",
          "command": "python3 tools/run_trt_pipeline.py --dataset /data/coco-yolo --onnx-template /data/models/{bucket}.onnx --precision fp16 --combined-output output0 --boxes-scale abs --min-score 0.0 --topk 300 --max-images 500"
        }
      ],
      "docs": ["deploy/runpod/README.md", "docs/tensorrt_pipeline.md"]
    },
    {
      "id": "benchmark_latency",
      "entrypoint": "tools/benchmark_latency.py",
      "runner": "python3",
      "summary": "Latency/FPS benchmark harness producing stable JSON reports and optional JSONL history.",
      "tags": ["benchmark", "realtime"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "produces": ["metrics_report_json"] },
      "inputs": [
        { "name": "config", "kind": "file", "required": false, "flag": "--config" },
        { "name": "model_template", "kind": "string", "required": false, "flag": "--model-template" },
        { "name": "engine_template", "kind": "string", "required": false, "flag": "--engine-template" },
        { "name": "buckets", "kind": "string", "required": false, "flag": "--buckets" },
        { "name": "run_id", "kind": "string", "required": false, "flag": "--run-id" },
        { "name": "notes", "kind": "string", "required": false, "flag": "--notes" },
        { "name": "notes_file", "kind": "file", "required": false, "flag": "--notes-file" },
        { "name": "iterations", "kind": "number", "required": false, "flag": "--iterations" },
        { "name": "warmup", "kind": "number", "required": false, "flag": "--warmup" },
        { "name": "sleep_s", "kind": "number", "required": false, "flag": "--sleep-s" },
        { "name": "target_fps", "kind": "number", "required": false, "flag": "--target-fps" },
        { "name": "target_latency_ms", "kind": "number", "required": false, "flag": "--target-latency-ms" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/benchmark_latency.json" },
        { "name": "history", "kind": "file", "required": false, "flag": "--history", "default": null }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Write the benchmark JSON report." },
          { "flag": "--history", "kind": "file", "scope": "path", "description": "Optional JSONL history file to append benchmark reports to." }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "report_json", "kind": "file", "default": "reports/benchmark_latency.json" },
        { "name": "history_jsonl", "kind": "file", "description": "Optional JSONL history when --history is set." }
      ],
      "examples": [
        {
          "description": "Synthetic benchmark (no inference) to validate harness.",
          "command": "python3 tools/benchmark_latency.py --iterations 200 --warmup 20 --output reports/benchmark_latency.json --history reports/benchmark_latency.jsonl --notes \"baseline on target HW\""
        }
      ],
      "docs": ["docs/benchmark_latency.md"]
    },
    {
      "id": "publish_benchmark_table",
      "entrypoint": "tools/publish_benchmark_table.py",
      "runner": "python3",
      "summary": "Generate official benchmark publication table (JSON+Markdown) from benchmark reports with run-id traceability.",
      "tags": ["benchmark", "publication", "protocol", "report"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["metrics_report_json"] },
      "inputs": [
        { "name": "report", "kind": "file", "required": true, "flag": "--report", "description": "Repeatable benchmark report JSON input." },
        { "name": "output_json", "kind": "file", "required": false, "flag": "--output-json", "default": "reports/benchmark_table.json" },
        { "name": "output_md", "kind": "file", "required": false, "flag": "--output-md", "default": "reports/benchmark_table.md" },
        { "name": "title", "kind": "string", "required": false, "flag": "--title" },
        { "name": "cadence", "kind": "string", "required": false, "flag": "--cadence", "default": "weekly" },
        { "name": "protocol_id", "kind": "string", "required": false, "flag": "--protocol-id", "default": "yolo26" },
        { "name": "source_command", "kind": "string", "required": false, "flag": "--source-command" },
        { "name": "publication_run_id", "kind": "string", "required": false, "flag": "--publication-run-id" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output-json", "kind": "file", "scope": "path", "description": "Writes benchmark table JSON artifact." },
          { "flag": "--output-md", "kind": "file", "scope": "path", "description": "Writes benchmark table Markdown artifact." }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "benchmark_table_json", "kind": "file", "default": "reports/benchmark_table.json" },
        { "name": "benchmark_table_md", "kind": "file", "default": "reports/benchmark_table.md" }
      ],
      "examples": [
        {
          "description": "Publish official benchmark table from one or more benchmark reports.",
          "command": "python3 tools/publish_benchmark_table.py --report reports/benchmark_latency.json --output-json reports/benchmark_table.json --output-md reports/benchmark_table.md --source-command \"python3 tools/benchmark_latency.py --config configs/benchmark_latency_example.json\""
        }
      ],
      "docs": ["docs/benchmark_publication.md", "docs/yolo26_eval_protocol.md"]
    },
    {
      "id": "eval_cotta_drift",
      "entrypoint": "tools/eval_cotta_drift.py",
      "runner": "python3",
      "summary": "Compare baseline-vs-CoTTA TTT reports and generate reproducible drift/stability evidence artifacts (JSON+Markdown).",
      "tags": ["tta", "cotta", "drift", "validation", "report"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"] },
      "inputs": [
        { "name": "baseline", "kind": "file", "required": true, "flag": "--baseline", "description": "Wrapped predictions JSON for baseline TTT run." },
        { "name": "cotta", "kind": "file", "required": true, "flag": "--cotta", "description": "Wrapped predictions JSON for CoTTA run." },
        { "name": "output_json", "kind": "file", "required": false, "flag": "--output-json", "default": "reports/cotta_drift_report.json" },
        { "name": "output_md", "kind": "file", "required": false, "flag": "--output-md", "default": "reports/cotta_drift_report.md" },
        { "name": "stability_loss_ratio_threshold", "kind": "number", "required": false, "flag": "--stability-loss-ratio-threshold", "default": 1.0 },
        { "name": "max_safe_total_update_norm", "kind": "number", "required": false, "flag": "--max-safe-total-update-norm", "default": 5.0 }
      ],
      "effects": {
        "writes": [
          { "flag": "--output-json", "kind": "file", "scope": "path", "description": "Writes CoTTA drift validation JSON evidence artifact." },
          { "flag": "--output-md", "kind": "file", "scope": "path", "description": "Writes CoTTA drift validation Markdown summary." }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "cotta_drift_report_json", "kind": "file", "default": "reports/cotta_drift_report.json" },
        { "name": "cotta_drift_report_md", "kind": "file", "default": "reports/cotta_drift_report.md" }
      ],
      "examples": [
        {
          "description": "Compare baseline and CoTTA wrapped predictions for drift/stability validation.",
          "command": "python3 tools/eval_cotta_drift.py --baseline reports/preds_baseline_ttt.json --cotta reports/preds_cotta_ttt.json --output-json reports/cotta_drift_report.json --output-md reports/cotta_drift_report.md --stability-loss-ratio-threshold 1.0 --max-safe-total-update-norm 5.0"
        }
      ],
      "docs": ["docs/cotta_design_spec.md", "docs/cotta_validation.md"]
    },
    {
      "id": "benchmark_keypoints_eval",
      "entrypoint": "tools/benchmark_keypoints_eval.py",
      "runner": "python3",
      "summary": "Benchmark keypoints evaluation runtime (PCK + optional OKS mAP) and write a stable JSON report.",
      "tags": ["benchmark", "keypoints", "pose", "eval"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"], "produces": ["metrics_report_json"] },
      "inputs": [
        { "name": "dataset", "kind": "dir", "required": true, "flag": "--dataset" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split" },
        { "name": "predictions", "kind": "file", "required": true, "flag": "--predictions" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "warmup", "kind": "number", "required": false, "flag": "--warmup" },
        { "name": "iterations", "kind": "number", "required": false, "flag": "--iterations" },
        { "name": "iou_threshold", "kind": "number", "required": false, "flag": "--iou-threshold" },
        { "name": "min_score", "kind": "number", "required": false, "flag": "--min-score" },
        { "name": "pck_threshold", "kind": "number", "required": false, "flag": "--pck-threshold" },
        { "name": "oks", "kind": "string", "required": false, "flag": "--oks" },
        { "name": "oks_sigmas", "kind": "string", "required": false, "flag": "--oks-sigmas" },
        { "name": "oks_sigmas_file", "kind": "file", "required": false, "flag": "--oks-sigmas-file" },
        { "name": "oks_max_dets", "kind": "number", "required": false, "flag": "--oks-max-dets" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/benchmark_keypoints_eval.json" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Write the benchmark evaluation JSON report." }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "report_json", "kind": "file", "default": "reports/benchmark_keypoints_eval.json" }],
      "examples": [
        {
          "description": "Quick PCK eval benchmark on a small slice.",
          "command": "python3 tools/benchmark_keypoints_eval.py --dataset data/coco128 --predictions reports/predictions.json --max-images 50 --warmup 1 --iterations 5 --output reports/benchmark_keypoints_eval.json"
        }
      ]
    },
    {
      "id": "benchmark_eata_stability",
      "entrypoint": "tools/benchmark_eata_stability.py",
      "runner": "python3",
      "summary": "Benchmark EATA stability/efficiency tradeoffs versus baseline TTT and emit recommended defaults.",
      "tags": ["tta", "eata", "benchmark", "stability", "efficiency", "report"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"] },
      "inputs": [
        { "name": "baseline", "kind": "file", "required": true, "flag": "--baseline" },
        { "name": "eata", "kind": "file", "required": true, "flag": "--eata" },
        { "name": "output_json", "kind": "file", "required": false, "flag": "--output-json", "default": "reports/eata_benchmark.json" },
        { "name": "output_md", "kind": "file", "required": false, "flag": "--output-md", "default": "reports/eata_benchmark.md" },
        { "name": "max_overhead_ratio", "kind": "number", "required": false, "flag": "--max-overhead-ratio", "default": 1.5 },
        { "name": "max_loss_ratio", "kind": "number", "required": false, "flag": "--max-loss-ratio", "default": 1.05 },
        { "name": "min_selected_ratio", "kind": "number", "required": false, "flag": "--min-selected-ratio", "default": 0.1 }
      ],
      "effects": {
        "writes": [
          { "flag": "--output-json", "kind": "file", "scope": "path", "description": "Writes EATA benchmark JSON artifact." },
          { "flag": "--output-md", "kind": "file", "scope": "path", "description": "Writes EATA benchmark Markdown summary." }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "eata_benchmark_json", "kind": "file", "default": "reports/eata_benchmark.json" },
        { "name": "eata_benchmark_md", "kind": "file", "default": "reports/eata_benchmark.md" }
      ],
      "examples": [
        {
          "description": "Benchmark baseline vs EATA tradeoffs and generate recommended defaults.",
          "command": "python3 tools/benchmark_eata_stability.py --baseline reports/preds_baseline_ttt.json --eata reports/preds_eata_ttt.json --output-json reports/eata_benchmark.json --output-md reports/eata_benchmark.md --max-overhead-ratio 1.5 --max-loss-ratio 1.05 --min-selected-ratio 0.1"
        }
      ],
      "docs": ["docs/eata_design_spec.md", "docs/eata_benchmark.md"]
    },
    {
      "id": "benchmark_sar_robustness",
      "entrypoint": "tools/benchmark_sar_robustness.py",
      "runner": "python3",
      "summary": "Benchmark SAR robustness gains and side effects versus CoTTA/EATA and emit a go/no-go report.",
      "tags": ["tta", "sar", "benchmark", "robustness", "report"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "consumes": ["predictions_json"] },
      "inputs": [
        { "name": "cotta", "kind": "file", "required": true, "flag": "--cotta" },
        { "name": "eata", "kind": "file", "required": true, "flag": "--eata" },
        { "name": "sar", "kind": "file", "required": true, "flag": "--sar" },
        { "name": "output_json", "kind": "file", "required": false, "flag": "--output-json", "default": "reports/sar_robustness_report.json" },
        { "name": "output_md", "kind": "file", "required": false, "flag": "--output-md", "default": "reports/sar_robustness_report.md" },
        { "name": "max_overhead_ratio", "kind": "number", "required": false, "flag": "--max-overhead-ratio", "default": 1.5 },
        { "name": "max_loss_ratio", "kind": "number", "required": false, "flag": "--max-loss-ratio", "default": 1.05 },
        { "name": "max_variance_ratio", "kind": "number", "required": false, "flag": "--max-variance-ratio", "default": 1.2 }
      ],
      "effects": {
        "writes": [
          { "flag": "--output-json", "kind": "file", "scope": "path", "description": "Writes SAR robustness benchmark JSON artifact." },
          { "flag": "--output-md", "kind": "file", "scope": "path", "description": "Writes SAR robustness benchmark Markdown summary." }
        ],
        "fixed_writes": []
      },
      "outputs": [
        { "name": "sar_robustness_json", "kind": "file", "default": "reports/sar_robustness_report.json" },
        { "name": "sar_robustness_md", "kind": "file", "default": "reports/sar_robustness_report.md" }
      ],
      "examples": [
        {
          "description": "Benchmark SAR against CoTTA/EATA references and produce go/no-go evidence.",
          "command": "python3 tools/benchmark_sar_robustness.py --cotta reports/preds_cotta_ttt.json --eata reports/preds_eata_ttt.json --sar reports/preds_sar_ttt.json --output-json reports/sar_robustness_report.json --output-md reports/sar_robustness_report.md --max-overhead-ratio 1.5 --max-loss-ratio 1.05 --max-variance-ratio 1.2"
        }
      ],
      "docs": ["docs/sar_design_spec.md", "docs/sar_evaluation.md"]
    },
    {
      "id": "run_scenarios",
      "entrypoint": "tools/run_scenarios.py",
      "runner": "python3",
      "summary": "Run the scenario suite pipeline (adapter + constraints utilities) and write a report JSON.",
      "tags": ["scenarios", "pipeline"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "contracts": { "produces": ["metrics_report_json"] },
      "inputs": [
        { "name": "config", "kind": "file", "required": false, "flag": "--config" },
        { "name": "adapter", "kind": "string", "required": false, "flag": "--adapter" },
        { "name": "dataset", "kind": "dir", "required": false, "flag": "--dataset" },
        { "name": "split", "kind": "string", "required": false, "flag": "--split" },
        { "name": "predictions", "kind": "file", "required": false, "flag": "--predictions" },
        { "name": "checkpoint", "kind": "file", "required": false, "flag": "--checkpoint" },
        { "name": "device", "kind": "string", "required": false, "flag": "--device" },
        { "name": "image_size", "kind": "string", "required": false, "flag": "--image-size" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "max_detections", "kind": "number", "required": false, "flag": "--max-detections" },
        { "name": "score_threshold", "kind": "number", "required": false, "flag": "--score-threshold" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/scenario_run.json" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Write the scenario JSON report." }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "scenario_run_json", "kind": "file", "default": "reports/scenario_run.json" }],
      "examples": [
        { "description": "Run a basic dummy scenario pass.", "command": "python3 tools/run_scenarios.py --adapter dummy --dataset data/coco128 --max-images 50" }
      ]
    },
    {
      "id": "check_license_policy",
      "entrypoint": "tools/check_license_policy.py",
      "runner": "python3",
      "summary": "Enforce Apache-2.0-only constraints (denylist + no vendored GPL/AGPL license texts).",
      "tags": ["policy", "license"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "inputs": [],
      "effects": { "writes": [], "fixed_writes": [] },
      "outputs": [{ "name": "stdout", "kind": "stdout", "description": "OK or failure reason." }],
      "examples": [{ "description": "Run policy checks.", "command": "python3 tools/check_license_policy.py" }],
      "docs": ["docs/license_policy.md"]
    },
    {
      "id": "report_dependency_licenses",
      "entrypoint": "tools/report_dependency_licenses.py",
      "runner": "python3",
      "summary": "Generate a best-effort dependency license report from installed Python packages (not legal advice).",
      "tags": ["policy", "license"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "inputs": [
        { "name": "output", "kind": "file", "required": false, "flag": "--output", "default": "reports/dependency_licenses.json" },
        { "name": "requirements", "kind": "file", "required": false, "flag": "--requirements" },
        { "name": "only_direct", "kind": "string", "required": false, "flag": "--only-direct" },
        { "name": "fail_on_copyleft", "kind": "string", "required": false, "flag": "--fail-on-copyleft" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Write the dependency license JSON report." }
        ],
        "fixed_writes": []
      },
      "outputs": [{ "name": "dependency_licenses_json", "kind": "file", "default": "reports/dependency_licenses.json" }],
      "examples": [
        {
          "description": "Write a dependency license report for the current environment.",
          "command": "python3 tools/report_dependency_licenses.py --output reports/dependency_licenses.json"
        }
      ],
      "docs": ["docs/license_policy.md"]
    },
    {
      "id": "rtdetr_pose_train_continual",
      "entrypoint": "rtdetr_pose/tools/train_continual.py",
      "runner": "python3",
      "summary": "Continual fine-tuning runner for rtdetr_pose that wires replay + checkpoint-based self-distillation (passes --self-distill-from <prev_ckpt> to train_minimal), with optional LoRA/EWC/SI. Backbone swaps are configured via model.backbone.* in the model config (P3/P4/P5 contract).",
      "tags": ["rtdetr_pose", "continual", "train", "replay", "self_distill", "distill", "lora", "ewc", "si", "backbone"],
      "platform": {
        "cpu_ok": true,
        "gpu_required": false,
        "macos_ok": true,
        "linux_ok": true,
        "notes": "CPU works for smoke runs; GPU is recommended for real training."
      },
      "requires": { "python_packages": ["torch", "PyYAML"] },
      "inputs": [
        { "name": "config", "kind": "file", "required": true, "flag": "--config" },
        { "name": "run_dir", "kind": "dir", "required": false, "flag": "--run-dir" },
        { "name": "replay_size", "kind": "number", "required": false, "flag": "--replay-size" },
        { "name": "replay_fraction", "kind": "number", "required": false, "flag": "--replay-fraction" },
        { "name": "replay_per_task_cap", "kind": "number", "required": false, "flag": "--replay-per-task-cap" }
      ],
      "effects": {
        "writes": [
          { "flag": "--run-dir", "kind": "dir", "scope": "tree", "description": "Optional explicit run directory." }
        ],
        "fixed_writes": [
          { "path": "runs/continual", "kind": "dir", "scope": "tree", "description": "Default run root when --run-dir is not set." }
        ]
      },
      "outputs": [{ "name": "run_json", "kind": "file", "description": "continual_run.json under the run dir." }],
      "examples": [
        {
          "description": "Domain-incremental continual fine-tuning (example config).",
          "command": "python3 rtdetr_pose/tools/train_continual.py --config configs/continual/rtdetr_pose_domain_inc_example.yaml"
        },
        {
          "description": "Memoryless mode (disable replay; still uses previous-checkpoint self-distillation when distill.enabled).",
          "command": "python3 rtdetr_pose/tools/train_continual.py --config configs/continual/rtdetr_pose_domain_inc_example.yaml --replay-size 0"
        }
      ],
      "docs": ["docs/continual_learning.md", "docs/backbones.md", "docs/training_inference_export.md", "rtdetr_pose/README.md"]
    },
    {
      "id": "eval_continual",
      "entrypoint": "tools/eval_continual.py",
      "runner": "python3",
      "summary": "Evaluate a continual learning run (simple mAP proxy or pose metrics + forgetting) and write JSON+HTML.",
      "tags": ["continual", "eval", "report", "forgetting"],
      "platform": { "cpu_ok": true, "gpu_required": false, "macos_ok": true, "linux_ok": true },
      "requires": { "python_packages": ["torch", "Pillow"] },
      "inputs": [
        { "name": "run_json", "kind": "file", "required": true, "flag": "--run-json" },
        { "name": "device", "kind": "string", "required": false, "flag": "--device" },
        { "name": "metric", "kind": "string", "required": false, "flag": "--metric" },
        { "name": "metric_key", "kind": "string", "required": false, "flag": "--metric-key" },
        { "name": "image_size", "kind": "string", "required": false, "flag": "--image-size" },
        { "name": "max_images", "kind": "number", "required": false, "flag": "--max-images" },
        { "name": "iou_threshold", "kind": "number", "required": false, "flag": "--iou-threshold" },
        { "name": "min_score", "kind": "number", "required": false, "flag": "--min-score" },
        { "name": "keep_per_image", "kind": "number", "required": false, "flag": "--keep-per-image" },
        { "name": "success_trans", "kind": "number", "required": false, "flag": "--success-trans" },
        { "name": "success_rot_deg", "kind": "number", "required": false, "flag": "--success-rot-deg" },
        { "name": "force", "kind": "string", "required": false, "flag": "--force" },
        { "name": "output", "kind": "file", "required": false, "flag": "--output" },
        { "name": "html", "kind": "file", "required": false, "flag": "--html" }
      ],
      "effects": {
        "writes": [
          { "flag": "--output", "kind": "file", "scope": "path", "description": "Optional explicit JSON output path." },
          { "flag": "--html", "kind": "file", "scope": "path", "description": "Optional explicit HTML output path." }
        ],
        "fixed_writes": [
          { "path": "runs/continual", "kind": "dir", "scope": "tree", "description": "Default outputs are written next to the run dir when using standard runs/continual locations." }
        ]
      },
      "outputs": [
        { "name": "eval_json", "kind": "file", "description": "<run_dir>/continual_eval.json by default." },
        { "name": "eval_html", "kind": "file", "description": "<run_dir>/continual_eval.html by default." }
      ],
      "examples": [
        {
          "description": "Evaluate and summarize forgetting.",
          "command": "python3 tools/eval_continual.py --run-json runs/continual/<run>/continual_run.json --device cpu --max-images 50"
        },
        {
          "description": "Pose-mode evaluation (requires pose sidecar metadata in labels).",
          "command": "python3 tools/eval_continual.py --run-json runs/continual/<run>/continual_run.json --device cpu --max-images 50 --metric pose --metric-key pose_success"
        }
      ],
      "docs": ["docs/continual_learning.md"]
    }
  ]
}
